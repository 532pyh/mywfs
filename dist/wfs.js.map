{
  "version": 3,
  "sources": [
    "node_modules\\browser-pack\\_prelude.js",
    "node_modules\\events\\events.js",
    "src\\controller\\buffer-controller.js",
    "src\\controller\\flow-controller.js",
    "src\\demux\\exp-golomb.js",
    "src\\demux\\h264-demuxer.js",
    "src\\errors.js",
    "src\\event-handler.js",
    "src\\events.js",
    "src\\helper\\aac.js",
    "src\\index.js",
    "src\\loader\\websocket-loader.js",
    "src\\remux\\mp4-generator.js",
    "src\\remux\\mp4-remuxer.js",
    "src\\utils\\h264-nal-slicesreader.js",
    "src\\utils\\logger.js",
    "src\\utils\\polyfill.js",
    "src\\utils\\xhr-loader.js",
    "src\\wfs.js"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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",
  "file": "generated.js",
  "sourceRoot": "",
  "sourcesContent": [
    "(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",
    "// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n",
    "/*\r\n * Buffer Controller\r\n*/\r\n\r\nimport Event from '../events';\r\nimport EventHandler from '../event-handler';\r\n \r\nclass BufferController extends EventHandler {\r\n\r\n  constructor(wfs) {\r\n    super(wfs,\r\n      Event.MEDIA_ATTACHING,\r\n      Event.BUFFER_APPENDING,\r\n      Event.BUFFER_RESET\r\n    );\r\n    \r\n    this.mediaSource = null;\r\n    this.media = null;\r\n    this.pendingTracks = {};\r\n    this.sourceBuffer = {};\r\n    this.segments = [];\r\n \r\n    this.appended = 0;\r\n    this._msDuration = null;\r\n\r\n    // Source Buffer listeners\r\n    this.onsbue = this.onSBUpdateEnd.bind(this);\r\n\r\n    this.browserType = 0;\r\n    if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1){\r\n      this.browserType = 1;\r\n    }\r\n    this.mediaType = 'H264Raw';\r\n\r\n    this.websocketName = undefined; \r\n    this.channelName = undefined;\r\n  }\r\n\r\n  destroy() {\r\n    EventHandler.prototype.destroy.call(this);\r\n  }\r\n \r\n  onMediaAttaching(data) {\r\n    let media = this.media = data.media;\r\n    this.mediaType = data.mediaType;\r\n    this.websocketName = data.websocketName;\r\n    this.channelName = data.channelName;\r\n    if (media) {\r\n      // setup the media source\r\n      var ms = this.mediaSource = new MediaSource();\r\n      //Media Source listeners\r\n      this.onmso = this.onMediaSourceOpen.bind(this);\r\n      this.onmse = this.onMediaSourceEnded.bind(this);\r\n      this.onmsc = this.onMediaSourceClose.bind(this);\r\n      ms.addEventListener('sourceopen', this.onmso);\r\n      ms.addEventListener('sourceended', this.onmse);\r\n      ms.addEventListener('sourceclose', this.onmsc);\r\n      // link video and media Source\r\n      media.src = URL.createObjectURL(ms);\r\n    }\r\n  }\r\n\r\n  onMediaDetaching() {\r\n \r\n  }\r\n   \r\n  onBufferAppending(data) { \r\n    if (!this.segments) {\r\n      this.segments = [ data ];\r\n    } else {\r\n      this.segments.push(data); \r\n    }\r\n    this.doAppending(); \r\n  }\r\n  \r\n  onMediaSourceClose() {\r\n    console.log('media source closed');\r\n  }\r\n\r\n  onMediaSourceEnded() {\r\n    console.log('media source ended');\r\n  }\r\n\r\n  onSBUpdateEnd(event) { \r\n    // Firefox\r\n    if (this.browserType === 1){\r\n      this.mediaSource.endOfStream();\r\n      this.media.play();  \r\n    }\r\n \r\n    this.appending = false;\r\n    this.doAppending();\r\n    this.updateMediaElementDuration();\r\n \r\n  }\r\n \r\n  updateMediaElementDuration() {\r\n  \r\n  }\r\n\r\n  onMediaSourceOpen() { \r\n    let mediaSource = this.mediaSource;\r\n    if (mediaSource) {\r\n      // once received, don't listen anymore to sourceopen event\r\n      mediaSource.removeEventListener('sourceopen', this.onmso);\r\n    }\r\n\r\n    if (this.mediaType === 'FMp4'){ \r\n      this.checkPendingTracks();\r\n    }\r\n\r\n    this.wfs.trigger(Event.MEDIA_ATTACHED, {media:this.media, channelName:this.channelName, mediaType: this.mediaType, websocketName:this.websocketName});\r\n  }\r\n\r\n  checkPendingTracks() {  \r\n    this.createSourceBuffers({ tracks : 'video' , mimeType:'' } );\r\n    this.pendingTracks = {};  \r\n  }\r\n\r\n  onBufferReset(data) { \r\n    if (this.mediaType === 'H264Raw'){ \r\n      this.createSourceBuffers({ tracks : 'video' , mimeType: data.mimeType } );\r\n    }\r\n  }\r\n \r\n  createSourceBuffers(tracks) {\r\n    var sourceBuffer = this.sourceBuffer,mediaSource = this.mediaSource;\r\n    let mimeType;\r\n    if (tracks.mimeType === ''){\r\n      mimeType = 'video/mp4;codecs=avc1.420028'; // avc1.42c01f avc1.42801e avc1.640028 avc1.420028\r\n    }else{\r\n      mimeType = 'video/mp4;codecs=' + tracks.mimeType;\r\n    }\r\n \r\n    try {\r\n      let sb = sourceBuffer['video'] = mediaSource.addSourceBuffer(mimeType);\r\n      sb.addEventListener('updateend', this.onsbue);\r\n      track.buffer = sb;\r\n    } catch(err) {\r\n\r\n    }\r\n    this.wfs.trigger(Event.BUFFER_CREATED, { tracks : tracks } );\r\n    this.media.play();    \r\n  }\r\n\r\n  doAppending() {\r\n   \r\n    var wfs = this.wfs, sourceBuffer = this.sourceBuffer, segments = this.segments;\r\n    if (Object.keys(sourceBuffer).length) {\r\n       \r\n      if (this.media.error) {\r\n        this.segments = [];\r\n        console.log('trying to append although a media error occured, flush segment and abort');\r\n        return;\r\n      }\r\n      if (this.appending) { \r\n        return;\r\n      }\r\n         \r\n      if (segments && segments.length) { \r\n        var segment = segments.shift();\r\n        try {\r\n          if(sourceBuffer[segment.type]) { \r\n            this.parent = segment.parent;\r\n            sourceBuffer[segment.type].appendBuffer(segment.data);\r\n            this.appendError = 0;\r\n            this.appended++;\r\n            this.appending = true;\r\n          } else {\r\n  \r\n          }\r\n        } catch(err) {\r\n          // in case any error occured while appending, put back segment in segments table \r\n          segments.unshift(segment);\r\n          var event = {type: ErrorTypes.MEDIA_ERROR};\r\n          if(err.code !== 22) {\r\n            if (this.appendError) {\r\n              this.appendError++;\r\n            } else {\r\n              this.appendError = 1;\r\n            }\r\n            event.details = ErrorDetails.BUFFER_APPEND_ERROR;\r\n            event.frag = this.fragCurrent;   \r\n            if (this.appendError > wfs.config.appendErrorMaxRetry) { \r\n              segments = [];\r\n              event.fatal = true;    \r\n              return;\r\n            } else {\r\n              event.fatal = false; \r\n            }\r\n          } else { \r\n            this.segments = [];\r\n            event.details = ErrorDetails.BUFFER_FULL_ERROR; \r\n            return;\r\n          } \r\n        }\r\n        \r\n      }\r\n    }\r\n  }\r\n \r\n}\r\n\r\nexport default BufferController;\r\n",
    "/*\r\n * Flow Controller\r\n*/\r\n \r\nimport Event from '../events';\r\nimport EventHandler from '../event-handler'; \r\n\r\nclass FlowController extends EventHandler {\r\n\r\n  constructor(wfs) {\r\n    super(wfs,\r\n      Event.MEDIA_ATTACHED,\r\n      Event.BUFFER_CREATED,\r\n      Event.FILE_PARSING_DATA,\r\n      Event.FILE_HEAD_LOADED,\r\n      Event.FILE_DATA_LOADED,\r\n      Event.WEBSOCKET_ATTACHED,\r\n      Event.FRAG_PARSING_DATA,\r\n      Event.FRAG_PARSING_INIT_SEGMENT);\r\n    \r\n    this.fileStart = 0;\r\n    this.fileEnd = 0;\r\n    this.pendingAppending = 0;\r\n    this.mediaType = undefined; \r\n    channelName:this.channelName;\r\n  }\r\n\r\n  destroy() {\r\n     EventHandler.prototype.destroy.call(this);\r\n  }  \r\n\r\n  onMediaAttached(data) {      \r\n    if (data.websocketName != undefined){\r\n      var client = new WebSocket( 'ws://' + window.location.host + '/' +  data.websocketName );\r\n      this.wfs.attachWebsocket(client,data.channelName);\r\n    }else{\r\n       console.log('websocketName ERROE!!!');\r\n    }\r\n\r\n  }\r\n  \r\n  onBufferCreated(data) {\r\n    this.mediaType = data.mediaType; \r\n  }\r\n\r\n  onFileHeadLoaded(data) { \r\n  }\r\n\r\n  onFileDataLoaded(data) { \r\n  }\r\n\r\n  onFileParsingData(data) {\r\n  }\r\n \r\n  onWebsocketAttached(data) {\r\n    this.wfs.trigger(Event.BUFFER_APPENDING, {type: 'video', data: data.payload, parent : 'main'}); \r\n  }\r\n  \r\n  onFragParsingInitSegment(data) {\r\n  \t var tracks = data.tracks, trackName, track;\r\n \r\n      track = tracks.video;\r\n      if(track) { \r\n        track.id = data.id;\r\n      }\r\n \r\n      for (trackName in tracks) {\r\n        track = tracks[trackName];\r\n        var initSegment = track.initSegment;\r\n        if (initSegment) {\r\n          this.pendingAppending++;\r\n          this.wfs.trigger(Event.BUFFER_APPENDING, {type: trackName, data: initSegment, parent : 'main'});\r\n        }\r\n      }\r\n \r\n  }\r\n\r\n  onFragParsingData(data) {\r\n \r\n      if(data.type === 'video') {\r\n     \r\n      }\r\n       \r\n      [data.data1, data.data2].forEach(buffer => {\r\n        if (buffer) {\r\n          this.pendingAppending++;\r\n          this.wfs.trigger(Event.BUFFER_APPENDING, {type: data.type, data: buffer, parent : 'main'}); \r\n        }\r\n      });\r\n \r\n  }\r\n\r\n}\r\nexport default FlowController;  ",
    "/**\r\n * Parser for exponential Golomb codes, a variable-bitwidth number encoding scheme used by h264.\r\n*/\r\n\r\nimport {logger} from '../utils/logger';\r\n\r\nclass ExpGolomb {\r\n\r\n  constructor(data) {\r\n    this.data = data;\r\n    // the number of bytes left to examine in this.data\r\n    this.bytesAvailable = this.data.byteLength;\r\n    // the current word being examined\r\n    this.word = 0; // :uint\r\n    // the number of bits left to examine in the current word\r\n    this.bitsAvailable = 0; // :uint\r\n  }\r\n\r\n  // ():void\r\n  loadWord() {\r\n    var\r\n      position = this.data.byteLength - this.bytesAvailable,\r\n      workingBytes = new Uint8Array(4),\r\n      availableBytes = Math.min(4, this.bytesAvailable);\r\n    if (availableBytes === 0) {\r\n      throw new Error('no bytes available');\r\n    }\r\n    workingBytes.set(this.data.subarray(position, position + availableBytes));\r\n    this.word = new DataView(workingBytes.buffer).getUint32(0);\r\n    // track the amount of this.data that has been processed\r\n    this.bitsAvailable = availableBytes * 8;\r\n    this.bytesAvailable -= availableBytes;\r\n  }\r\n\r\n  // (count:int):void\r\n  skipBits(count) {\r\n    var skipBytes; // :int\r\n    if (this.bitsAvailable > count) {\r\n      this.word <<= count;\r\n      this.bitsAvailable -= count;\r\n    } else {\r\n      count -= this.bitsAvailable;\r\n      skipBytes = count >> 3;\r\n      count -= (skipBytes >> 3);\r\n      this.bytesAvailable -= skipBytes;\r\n      this.loadWord();\r\n      this.word <<= count;\r\n      this.bitsAvailable -= count;\r\n    }\r\n  }\r\n\r\n  // (size:int):uint\r\n  readBits(size) {\r\n    var\r\n      bits = Math.min(this.bitsAvailable, size), // :uint\r\n      valu = this.word >>> (32 - bits); // :uint\r\n    if (size > 32) {\r\n      logger.error('Cannot read more than 32 bits at a time');\r\n    }\r\n    this.bitsAvailable -= bits;\r\n    if (this.bitsAvailable > 0) {\r\n      this.word <<= bits;\r\n    } else if (this.bytesAvailable > 0) {\r\n      this.loadWord();\r\n    }\r\n    bits = size - bits;\r\n    if (bits > 0) {\r\n      return valu << bits | this.readBits(bits);\r\n    } else {\r\n      return valu;\r\n    }\r\n  }\r\n\r\n  // ():uint\r\n  skipLZ() {\r\n    var leadingZeroCount; // :uint\r\n    for (leadingZeroCount = 0; leadingZeroCount < this.bitsAvailable; ++leadingZeroCount) {\r\n      if (0 !== (this.word & (0x80000000 >>> leadingZeroCount))) {\r\n        // the first bit of working word is 1\r\n        this.word <<= leadingZeroCount;\r\n        this.bitsAvailable -= leadingZeroCount;\r\n        return leadingZeroCount;\r\n      }\r\n    }\r\n    // we exhausted word and still have not found a 1\r\n    this.loadWord();\r\n    return leadingZeroCount + this.skipLZ();\r\n  }\r\n\r\n  // ():void\r\n  skipUEG() {\r\n    this.skipBits(1 + this.skipLZ());\r\n  }\r\n\r\n  // ():void\r\n  skipEG() {\r\n    this.skipBits(1 + this.skipLZ());\r\n  }\r\n\r\n  // ():uint\r\n  readUEG() {\r\n    var clz = this.skipLZ(); // :uint\r\n    return this.readBits(clz + 1) - 1;\r\n  }\r\n\r\n  // ():int\r\n  readEG() {\r\n    var valu = this.readUEG(); // :int\r\n    if (0x01 & valu) {\r\n      // the number is odd if the low order bit is set\r\n      return (1 + valu) >>> 1; // add 1 to make it even, and divide by 2\r\n    } else {\r\n      return -1 * (valu >>> 1); // divide by two then make it negative\r\n    }\r\n  }\r\n\r\n  // Some convenience functions\r\n  // :Boolean\r\n  readBoolean() {\r\n    return 1 === this.readBits(1);\r\n  }\r\n\r\n  // ():int\r\n  readUByte() {\r\n    return this.readBits(8);\r\n  }\r\n\r\n  // ():int\r\n  readUShort() {\r\n    return this.readBits(16);\r\n  }\r\n    // ():int\r\n  readUInt() {\r\n    return this.readBits(32);\r\n  }\r\n\r\n  /**\r\n   * Advance the ExpGolomb decoder past a scaling list. The scaling\r\n   * list is optionally transmitted as part of a sequence parameter\r\n   * set and is not relevant to transmuxing.\r\n   * @param count {number} the number of entries in this scaling list\r\n   * @see Recommendation ITU-T H.264, Section 7.3.2.1.1.1\r\n   */\r\n  skipScalingList(count) {\r\n    var\r\n      lastScale = 8,\r\n      nextScale = 8,\r\n      j,\r\n      deltaScale;\r\n    for (j = 0; j < count; j++) {\r\n      if (nextScale !== 0) {\r\n        deltaScale = this.readEG();\r\n        nextScale = (lastScale + deltaScale + 256) % 256;\r\n      }\r\n      lastScale = (nextScale === 0) ? lastScale : nextScale;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Read a sequence parameter set and return some interesting video\r\n   * properties. A sequence parameter set is the H264 metadata that\r\n   * describes the properties of upcoming video frames.\r\n   * @param data {Uint8Array} the bytes of a sequence parameter set\r\n   * @return {object} an object with configuration parsed from the\r\n   * sequence parameter set, including the dimensions of the\r\n   * associated video frames.\r\n   */\r\n  readSPS() {\r\n    var\r\n      frameCropLeftOffset = 0,\r\n      frameCropRightOffset = 0,\r\n      frameCropTopOffset = 0,\r\n      frameCropBottomOffset = 0,\r\n      sarScale = 1,\r\n      profileIdc,profileCompat,levelIdc,\r\n      numRefFramesInPicOrderCntCycle, picWidthInMbsMinus1,\r\n      picHeightInMapUnitsMinus1,\r\n      frameMbsOnlyFlag,\r\n      scalingListCount,\r\n      i;\r\n    this.readUByte();\r\n    profileIdc = this.readUByte(); // profile_idc\r\n    profileCompat = this.readBits(5); // constraint_set[0-4]_flag, u(5)\r\n    this.skipBits(3); // reserved_zero_3bits u(3),\r\n    levelIdc = this.readUByte(); //level_idc u(8)\r\n    this.skipUEG(); // seq_parameter_set_id\r\n    // some profiles have more optional data we don't need\r\n    if (profileIdc === 100 ||\r\n        profileIdc === 110 ||\r\n        profileIdc === 122 ||\r\n        profileIdc === 244 ||\r\n        profileIdc === 44  ||\r\n        profileIdc === 83  ||\r\n        profileIdc === 86  ||\r\n        profileIdc === 118 ||\r\n        profileIdc === 128) {\r\n      var chromaFormatIdc = this.readUEG();\r\n      if (chromaFormatIdc === 3) {\r\n        this.skipBits(1); // separate_colour_plane_flag\r\n      }\r\n      this.skipUEG(); // bit_depth_luma_minus8\r\n      this.skipUEG(); // bit_depth_chroma_minus8\r\n      this.skipBits(1); // qpprime_y_zero_transform_bypass_flag\r\n      if (this.readBoolean()) { // seq_scaling_matrix_present_flag\r\n        scalingListCount = (chromaFormatIdc !== 3) ? 8 : 12;\r\n        for (i = 0; i < scalingListCount; i++) {\r\n          if (this.readBoolean()) { // seq_scaling_list_present_flag[ i ]\r\n            if (i < 6) {\r\n              this.skipScalingList(16);\r\n            } else {\r\n              this.skipScalingList(64);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    this.skipUEG(); // log2_max_frame_num_minus4\r\n    var picOrderCntType = this.readUEG();\r\n    if (picOrderCntType === 0) {\r\n      this.readUEG(); //log2_max_pic_order_cnt_lsb_minus4\r\n    } else if (picOrderCntType === 1) {\r\n      this.skipBits(1); // delta_pic_order_always_zero_flag\r\n      this.skipEG(); // offset_for_non_ref_pic\r\n      this.skipEG(); // offset_for_top_to_bottom_field\r\n      numRefFramesInPicOrderCntCycle = this.readUEG();\r\n      for(i = 0; i < numRefFramesInPicOrderCntCycle; i++) {\r\n        this.skipEG(); // offset_for_ref_frame[ i ]\r\n      }\r\n    }\r\n    this.skipUEG(); // max_num_ref_frames\r\n    this.skipBits(1); // gaps_in_frame_num_value_allowed_flag\r\n    picWidthInMbsMinus1 = this.readUEG();\r\n    picHeightInMapUnitsMinus1 = this.readUEG();\r\n    frameMbsOnlyFlag = this.readBits(1);\r\n    if (frameMbsOnlyFlag === 0) {\r\n      this.skipBits(1); // mb_adaptive_frame_field_flag\r\n    }\r\n    this.skipBits(1); // direct_8x8_inference_flag\r\n    if (this.readBoolean()) { // frame_cropping_flag\r\n      frameCropLeftOffset = this.readUEG();\r\n      frameCropRightOffset = this.readUEG();\r\n      frameCropTopOffset = this.readUEG();\r\n      frameCropBottomOffset = this.readUEG();\r\n    }\r\n    if (this.readBoolean()) {\r\n      // vui_parameters_present_flag\r\n      if (this.readBoolean()) {\r\n        // aspect_ratio_info_present_flag\r\n        let sarRatio;\r\n        const aspectRatioIdc = this.readUByte();\r\n        switch (aspectRatioIdc) {\r\n          case 1: sarRatio = [1,1]; break;\r\n          case 2: sarRatio = [12,11]; break;\r\n          case 3: sarRatio = [10,11]; break;\r\n          case 4: sarRatio = [16,11]; break;\r\n          case 5: sarRatio = [40,33]; break;\r\n          case 6: sarRatio = [24,11]; break;\r\n          case 7: sarRatio = [20,11]; break;\r\n          case 8: sarRatio = [32,11]; break;\r\n          case 9: sarRatio = [80,33]; break;\r\n          case 10: sarRatio = [18,11]; break;\r\n          case 11: sarRatio = [15,11]; break;\r\n          case 12: sarRatio = [64,33]; break;\r\n          case 13: sarRatio = [160,99]; break;\r\n          case 14: sarRatio = [4,3]; break;\r\n          case 15: sarRatio = [3,2]; break;\r\n          case 16: sarRatio = [2,1]; break;\r\n          case 255: {\r\n            sarRatio = [this.readUByte() << 8 | this.readUByte(), this.readUByte() << 8 | this.readUByte()];\r\n            break;\r\n          }\r\n        }\r\n        if (sarRatio) {\r\n          sarScale = sarRatio[0] / sarRatio[1];\r\n        }\r\n      }\r\n    }\r\n    return {\r\n      width: Math.ceil((((picWidthInMbsMinus1 + 1) * 16) - frameCropLeftOffset * 2 - frameCropRightOffset * 2) * sarScale),\r\n      height: ((2 - frameMbsOnlyFlag) * (picHeightInMapUnitsMinus1 + 1) * 16) - ((frameMbsOnlyFlag? 2 : 4) * (frameCropTopOffset + frameCropBottomOffset))\r\n    };\r\n  }\r\n\r\n  readSliceType() {\r\n    // skip NALu type\r\n    this.readUByte();\r\n    // discard first_mb_in_slice\r\n    this.readUEG();\r\n    // return slice_type\r\n    return this.readUEG();\r\n  }\r\n}\r\n\r\nexport default ExpGolomb;\r\n",
    "/**\r\n\r\n*/\r\nimport Event from '../events';\r\nimport ExpGolomb from './exp-golomb';\r\nimport EventHandler from '../event-handler';\r\nimport MP4Remuxer from '../remux/mp4-remuxer';\r\n\r\nclass h264Demuxer extends EventHandler {\r\n  \r\n  constructor(wfs, config=null) {\r\n    super(wfs, \r\n      Event.H264_DATA_PARSED);\r\n\r\n    this.config = this.wfs.config || config;\r\n    this.wfs = wfs;\r\n    this.id = 'main';\r\n \r\n    this.remuxer = new MP4Remuxer(this.wfs, this.id , this.config);   \r\n    this.contiguous = true; \r\n    this.timeOffset = 1;\r\n    this.sn = 0;\r\n    this.TIMESCALE = 90000; \r\n    this.timestamp = 0;\r\n    this.scaleFactor = this.TIMESCALE /1000;\r\n    this.H264_TIMEBASE = 3000;\r\n    this._avcTrack = {container : 'video/mp2t', type: 'video', id :1, sequenceNumber: 0,\r\n     samples : [], len : 0, nbNalu : 0, dropped : 0, count : 0 };\r\n    this.browserType = 0;\r\n    if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1){\r\n      this.browserType = 1;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    EventHandler.prototype.destroy.call(this);\r\n  }\r\n \r\n  getTimestampM() {\r\n    this.timestamp += this.H264_TIMEBASE;\r\n    return  this.timestamp;\r\n  }\r\n\r\n  onH264DataParsed(event){ \r\n    this._parseAVCTrack( event.data); \r\n    if (this.browserType === 1 || this._avcTrack.samples.length >= 20){ // Firefox\r\n      this.remuxer.pushVideo(0, this.sn, this._avcTrack, this.timeOffset, this.contiguous);\r\n      this.sn += 1;\r\n    }\r\n  } \r\n\r\n  _parseAVCTrack(array) {\r\n    var track = this._avcTrack,\r\n      samples = track.samples,\r\n      units = this._parseAVCNALu(array),\r\n      units2 = [],\r\n      debug = false,\r\n      key = false,\r\n      length = 0,\r\n      expGolombDecoder,\r\n      avcSample,\r\n      push,\r\n      i;    \r\n    var debugString = '';\r\n    var pushAccesUnit = function() {\r\n      if (units2.length) { \r\n        if (!this.config.forceKeyFrameOnDiscontinuity ||\r\n            key === true ||\r\n            (track.sps && (samples.length || this.contiguous))) { \r\n          var tss = this.getTimestampM();\r\n          avcSample = {units: { units : units2, length : length}, pts: tss, dts: tss, key: key};\r\n          samples.push(avcSample);\r\n          track.len += length;\r\n          track.nbNalu += units2.length;\r\n        } else { \r\n          track.dropped++;\r\n        }\r\n        units2 = [];\r\n        length = 0;\r\n      }\r\n    }.bind(this);\r\n\r\n    units.forEach(unit => {\r\n      switch(unit.type) {\r\n        //NDR\r\n         case 1:\r\n           push = true;\r\n           if(debug) {\r\n            debugString += 'NDR ';\r\n           }\r\n           break;\r\n        //IDR\r\n        case 5:\r\n          push = true;\r\n          if(debug) {\r\n            debugString += 'IDR ';\r\n          } \r\n          key = true;\r\n          break;\r\n        //SEI\r\n        case 6:\r\n          unit.data = this.discardEPB(unit.data);\r\n          expGolombDecoder = new ExpGolomb(unit.data);\r\n          // skip frameType\r\n          expGolombDecoder.readUByte();\r\n          break;\r\n        //SPS\r\n        case 7:\r\n          push = false;\r\n          if(debug) {\r\n            debugString += 'SPS ';\r\n          }\r\n          if(!track.sps) {\r\n            expGolombDecoder = new ExpGolomb(unit.data);\r\n            var config = expGolombDecoder.readSPS();\r\n            track.width = config.width;\r\n            track.height = config.height;\r\n            track.sps = [unit.data];\r\n            track.duration = 0; \r\n            var codecarray = unit.data.subarray(1, 4);\r\n            var codecstring = 'avc1.';\r\n            for (i = 0; i < 3; i++) {\r\n              var h = codecarray[i].toString(16);\r\n              if (h.length < 2) {\r\n                h = '0' + h;\r\n              }\r\n              codecstring += h;\r\n            }\r\n            track.codec = codecstring;         \r\n            this.wfs.trigger(Event.BUFFER_RESET, {  mimeType:  track.codec } ); \r\n            push = true;\r\n          }\r\n          break;\r\n        //PPS\r\n        case 8:\r\n          push = false;\r\n          if(debug) {\r\n            debugString += 'PPS ';\r\n          }\r\n          if (!track.pps) {\r\n            track.pps = [unit.data];\r\n             push = true;\r\n          }\r\n          break; \r\n        case 9:\r\n          push = false;\r\n          if(debug) {\r\n            debugString += 'AUD ';\r\n          }\r\n          pushAccesUnit();\r\n          break;      \r\n        default:\r\n          push = false;\r\n          debugString += 'unknown NAL ' + unit.type + ' ';\r\n          break;\r\n      }\r\n    \r\n      if(push) {\r\n        units2.push(unit);\r\n        length+=unit.data.byteLength; \r\n      }\r\n    \r\n    });\r\n    \r\n    if(debug || debugString.length) {\r\n      logger.log(debugString);\r\n    }\r\n    \r\n    pushAccesUnit();\r\n   \r\n  }\r\n  \r\n  _parseAVCNALu(array) {\r\n    var i = 0, len = array.byteLength, value, overflow, state = 0; //state = this.avcNaluState;\r\n    var units = [], unit, unitType, lastUnitStart, lastUnitType; \r\n    while (i < len) {\r\n      value = array[i++];\r\n      // finding 3 or 4-byte start codes (00 00 01 OR 00 00 00 01)\r\n      switch (state) {\r\n        case 0:\r\n          if (value === 0) {\r\n            state = 1;\r\n          }\r\n          break;\r\n        case 1:\r\n          if( value === 0) {\r\n            state = 2;\r\n          } else {\r\n            state = 0;\r\n          }\r\n          break;\r\n        case 2:\r\n        case 3:\r\n          if( value === 0) {\r\n            state = 3;\r\n          } else if (value === 1 && i < len) {\r\n            unitType = array[i] & 0x1f;\r\n            if (lastUnitStart) {\r\n              unit = {data: array.subarray(lastUnitStart, i - state - 1), type: lastUnitType}; \r\n              units.push(unit); \r\n            } else { \r\n            }\r\n            lastUnitStart = i;\r\n            lastUnitType = unitType;\r\n            state = 0;\r\n          } else {\r\n            state = 0;\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (lastUnitStart) { \r\n      unit = {data: array.subarray(lastUnitStart, len), type: lastUnitType, state : state};\r\n      units.push(unit); \r\n    }\r\n\r\n    return units;\r\n  }\r\n\r\n  /**\r\n   * remove Emulation Prevention bytes from a RBSP\r\n   */\r\n  discardEPB(data) {\r\n    var length = data.byteLength,\r\n        EPBPositions = [],\r\n        i = 1,\r\n        newLength, newData;\r\n    // Find all `Emulation Prevention Bytes`\r\n    while (i < length - 2) {\r\n      if (data[i] === 0 &&\r\n          data[i + 1] === 0 &&\r\n          data[i + 2] === 0x03) {\r\n        EPBPositions.push(i + 2);\r\n        i += 2;\r\n      } else {\r\n        i++;\r\n      }\r\n    }\r\n    // If no Emulation Prevention Bytes were found just return the original\r\n    // array\r\n    if (EPBPositions.length === 0) {\r\n      return data;\r\n    }\r\n    // Create a new array to hold the NAL unit data\r\n    newLength = length - EPBPositions.length;\r\n    newData = new Uint8Array(newLength);\r\n    var sourceIndex = 0;\r\n\r\n    for (i = 0; i < newLength; sourceIndex++, i++) {\r\n      if (sourceIndex === EPBPositions[0]) {\r\n        // Skip this byte\r\n        sourceIndex++;\r\n        // Remove this position index\r\n        EPBPositions.shift();\r\n      }\r\n      newData[i] = data[sourceIndex];\r\n    }\r\n    return newData;\r\n  }\r\n\r\n \r\n}\r\n\r\nexport default h264Demuxer;\r\n\r\n",
    "export const ErrorTypes = {\r\n  // Identifier for a network error (loading error / timeout ...)\r\n  NETWORK_ERROR: 'networkError',\r\n  // Identifier for a media Error (video/parsing/mediasource error)\r\n  MEDIA_ERROR: 'mediaError',\r\n  // Identifier for all other errors\r\n  OTHER_ERROR: 'otherError'\r\n};\r\n\r\nexport const ErrorDetails = {\r\n  // Identifier for a manifest load error - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  MANIFEST_LOAD_ERROR: 'manifestLoadError',\r\n  // Identifier for a manifest load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  MANIFEST_LOAD_TIMEOUT: 'manifestLoadTimeOut',\r\n  // Identifier for a manifest parsing error - data: { url : faulty URL, reason : error reason}\r\n  MANIFEST_PARSING_ERROR: 'manifestParsingError',\r\n  // Identifier for a manifest with only incompatible codecs error - data: { url : faulty URL, reason : error reason}\r\n  MANIFEST_INCOMPATIBLE_CODECS_ERROR: 'manifestIncompatibleCodecsError',\r\n  // Identifier for a level load error - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  LEVEL_LOAD_ERROR: 'levelLoadError',\r\n  // Identifier for a level load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  LEVEL_LOAD_TIMEOUT: 'levelLoadTimeOut',\r\n  // Identifier for a level switch error - data: { level : faulty level Id, event : error description}\r\n  LEVEL_SWITCH_ERROR: 'levelSwitchError',\r\n  // Identifier for an audio track load error - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  AUDIO_TRACK_LOAD_ERROR: 'audioTrackLoadError',\r\n  // Identifier for an audio track load timeout - data: { url : faulty URL, response : { code: error code, text: error text }}\r\n  AUDIO_TRACK_LOAD_TIMEOUT: 'audioTrackLoadTimeOut',\r\n  // Identifier for fragment load error - data: { frag : fragment object, response : { code: error code, text: error text }}\r\n  FRAG_LOAD_ERROR: 'fragLoadError',\r\n  // Identifier for fragment loop loading error - data: { frag : fragment object}\r\n  FRAG_LOOP_LOADING_ERROR: 'fragLoopLoadingError',\r\n  // Identifier for fragment load timeout error - data: { frag : fragment object}\r\n  FRAG_LOAD_TIMEOUT: 'fragLoadTimeOut',\r\n  // Identifier for a fragment decryption error event - data: parsing error description\r\n  FRAG_DECRYPT_ERROR: 'fragDecryptError',\r\n  // Identifier for a fragment parsing error event - data: parsing error description\r\n  FRAG_PARSING_ERROR: 'fragParsingError',\r\n  // Identifier for decrypt key load error - data: { frag : fragment object, response : { code: error code, text: error text }}\r\n  KEY_LOAD_ERROR: 'keyLoadError',\r\n  // Identifier for decrypt key load timeout error - data: { frag : fragment object}\r\n  KEY_LOAD_TIMEOUT: 'keyLoadTimeOut',\r\n  // Triggered when an exception occurs while adding a sourceBuffer to MediaSource - data : {  err : exception , mimeType : mimeType }\r\n  BUFFER_ADD_CODEC_ERROR: 'bufferAddCodecError',\r\n  // Identifier for a buffer append error - data: append error description\r\n  BUFFER_APPEND_ERROR: 'bufferAppendError',\r\n  // Identifier for a buffer appending error event - data: appending error description\r\n  BUFFER_APPENDING_ERROR: 'bufferAppendingError',\r\n  // Identifier for a buffer stalled error event\r\n  BUFFER_STALLED_ERROR: 'bufferStalledError',\r\n  // Identifier for a buffer full event\r\n  BUFFER_FULL_ERROR: 'bufferFullError',\r\n  // Identifier for a buffer seek over hole event\r\n  BUFFER_SEEK_OVER_HOLE: 'bufferSeekOverHole',\r\n  // Identifier for an internal exception happening inside hls.js while handling an event\r\n  INTERNAL_EXCEPTION: 'internalException'\r\n};\r\n",
    "/*\r\n*\r\n* All objects in the event handling chain should inherit from this class\r\n*\r\n*/ \r\nimport Event from './events';\r\n\r\nclass EventHandler {\r\n\r\n  constructor(wfs, ...events) {\r\n    this.wfs = wfs;\r\n    this.onEvent = this.onEvent.bind(this);\r\n    this.handledEvents = events;\r\n    this.useGenericHandler = true;\r\n\r\n    this.registerListeners();\r\n  }\r\n\r\n  destroy() {\r\n    this.unregisterListeners();\r\n  }\r\n\r\n  isEventHandler() {\r\n    return typeof this.handledEvents === 'object' && this.handledEvents.length && typeof this.onEvent === 'function';\r\n  }\r\n\r\n  registerListeners() {\r\n    if (this.isEventHandler()) {\r\n      this.handledEvents.forEach(function(event) {\r\n        if (event === 'wfsEventGeneric') {\r\n          //throw new Error('Forbidden event name: ' + event);\r\n        }\r\n        this.wfs.on(event, this.onEvent);\r\n      }.bind(this));\r\n    }\r\n  }\r\n\r\n  unregisterListeners() {\r\n    if (this.isEventHandler()) {\r\n      this.handledEvents.forEach(function(event) {\r\n        this.wfs.off(event, this.onEvent);\r\n      }.bind(this));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * arguments: event (string), data (any)\r\n   */\r\n  onEvent(event, data) {\r\n    this.onEventGeneric(event, data);\r\n  }\r\n\r\n  onEventGeneric(event, data) {\r\n    var eventToFunction = function(event, data) {\r\n      var funcName = 'on' + event.replace('wfs', '');\r\n      if (typeof this[funcName] !== 'function') {\r\n        //throw new Error(`Event ${event} has no generic handler in this ${this.constructor.name} class (tried ${funcName})`);\r\n      }\r\n      return this[funcName].bind(this, data);\r\n    };\r\n    try {\r\n      eventToFunction.call(this, event, data).call();\r\n    } catch (err) {\r\n      console.log(`internal error happened while processing ${event}:${err.message}`);\r\n   //   this.hls.trigger(Event.ERROR, {type: ErrorTypes.OTHER_ERROR, details: ErrorDetails.INTERNAL_EXCEPTION, fatal: false, event : event, err : err});\r\n    }\r\n  }\r\n}\r\n\r\nexport default EventHandler;\r\n",
    "module.exports = {\r\n \r\n  MEDIA_ATTACHING: 'wfsMediaAttaching',  \r\n \r\n  MEDIA_ATTACHED: 'wfsMediaAttached',\r\n \r\n  FRAG_LOADING: 'wfsFragLoading',\r\n\r\n  BUFFER_CREATED: 'wfsBufferCreated', \r\n\r\n  BUFFER_APPENDING: 'wfsBufferAppending',\r\n\r\n  BUFFER_RESET: 'wfsBufferReset', \r\n\r\n  FRAG_PARSING_DATA: 'wfsFragParsingData',\r\n \r\n  FRAG_PARSING_INIT_SEGMENT: 'wfsFragParsingInitSegment',\r\n//------------------------------------------\r\n  H264_DATA_PARSING: 'wfsH264DataParsing',\r\n\r\n  H264_DATA_PARSED: 'wfsH264DataParsed',\r\n//------------------------------------------\r\n  WEBSOCKET_ATTACHED: 'wfsWebsocketAttached',\r\n\r\n  WEBSOCKET_ATTACHING: 'wfsWebsocketAttaching',\r\n\r\n  WEBSOCKET_DATA_UPLOADING: 'wfsWebsocketDataUploading',\r\n\r\n  WEBSOCKET_MESSAGE_SENDING: 'wfsWebsocketMessageSending',   \r\n//------------------------------------------\r\n  FILE_HEAD_LOADING: 'wfsFileHeadLoading',\r\n\r\n  FILE_HEAD_LOADED: 'wfsFileHeadLoaded',\r\n\r\n  FILE_DATA_LOADING: 'wfsFileDataLoading',\r\n\r\n  FILE_DATA_LOADED: 'wfsFileDataLoaded',\r\n\r\n  FILE_PARSING_DATA: 'wfsFileParsingData'\r\n//------------------------------------------\r\n\r\n};\r\n",
    "/**\r\n *  AAC helper\r\n */\r\n\r\nclass AAC {\r\n  static getSilentFrame(channelCount) {\r\n    if (channelCount === 1) {\r\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\r\n    } else if (channelCount === 2) {\r\n      return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\r\n    } else if (channelCount === 3) {\r\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\r\n    } else if (channelCount === 4) {\r\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\r\n    } else if (channelCount === 5) {\r\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\r\n    } else if (channelCount === 6) {\r\n      return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\r\n    }\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default AAC;\r\n",
    "// This is mostly for support of the es6 module export\r\n// syntax with the babel compiler, it looks like it doesnt support\r\n// function exports like we are used to in node/commonjs\r\nmodule.exports = require('./wfs.js').default;\r\n",
    "/*\r\n * Websocket Loader\r\n*/\r\n\r\nimport Event from '../events';\r\nimport EventHandler from '../event-handler';\r\nimport SlicesReader from '../utils/h264-nal-slicesreader.js';\r\n\r\nclass WebsocketLoader extends EventHandler {\r\n\r\n  constructor(wfs) {\r\n    super(wfs, \r\n    Event.WEBSOCKET_ATTACHING,\r\n    Event.WEBSOCKET_DATA_UPLOADING,\r\n    Event.WEBSOCKET_MESSAGE_SENDING)   \r\n    this.buf = null;\r\n    this.slicesReader = new SlicesReader(wfs);\r\n    this.mediaType = undefined; \r\n    this.channelName = undefined; \r\n  }\r\n \r\n  destroy() { \r\n\t!!this.client && this.client.close();\r\n\tthis.slicesReader.destroy();\r\n    EventHandler.prototype.destroy.call(this);\r\n  }\r\n\r\n  onWebsocketAttaching(data) {\r\n  \tthis.mediaType = data.mediaType; \r\n  \tthis.channelName = data.channelName;  \r\n    if( data.websocket instanceof WebSocket ) {\r\n      this.client = data.websocket;\r\n      this.client.onopen = this.initSocketClient.bind(this);   \r\n      this.client.onclose = function(e) {\r\n          console.log('Websocket Disconnected!');\r\n      }; \r\n    }    \r\n  }\r\n\r\n  initSocketClient(client){\r\n    this.client.binaryType = 'arraybuffer';\r\n    this.client.onmessage = this.receiveSocketMessage.bind(this);\r\n    this.wfs.trigger(Event.WEBSOCKET_MESSAGE_SENDING, {commandType: \"open\", channelName:this.channelName, commandValue:\"NA\" });\r\n    console.log('Websocket Open!'); \r\n  }\r\n \r\n  receiveSocketMessage( event ){\r\n    this.buf = new Uint8Array(event.data);\r\n    var copy = new Uint8Array(this.buf);   \r\n    \r\n    if (this.mediaType ==='FMp4'){\r\n      this.wfs.trigger(Event.WEBSOCKET_ATTACHED, {payload: copy });\r\n    } \r\n    if (this.mediaType === 'H264Raw'){\r\n      this.wfs.trigger(Event.H264_DATA_PARSING, {data: copy });\r\n    }   \r\n  }\r\n\r\n  onWebsocketDataUploading( event ){\r\n    this.client.send( event.data );\r\n  }\r\n  \r\n  onWebsocketMessageSending( event ){  \r\n    this.client.send( JSON.stringify({ t: event.commandType, c:event.channelName, v: event.commandValue  }) );\r\n  }\r\n\r\n}\r\n\r\nexport default WebsocketLoader;  ",
    "/**\r\n * Generate MP4 Box\r\n*/\r\n\r\n//import Hex from '../utils/hex';\r\nclass MP4 {\r\n  static init() {\r\n    MP4.types = {\r\n      avc1: [], // codingname\r\n      avcC: [],\r\n      btrt: [],\r\n      dinf: [],\r\n      dref: [],\r\n      esds: [],\r\n      ftyp: [],\r\n      hdlr: [],\r\n      mdat: [],\r\n      mdhd: [],\r\n      mdia: [],\r\n      mfhd: [],\r\n      minf: [],\r\n      moof: [],\r\n      moov: [],\r\n      mp4a: [],\r\n      mvex: [],\r\n      mvhd: [],\r\n      sdtp: [],\r\n      stbl: [],\r\n      stco: [],\r\n      stsc: [],\r\n      stsd: [],\r\n      stsz: [],\r\n      stts: [],\r\n      tfdt: [],\r\n      tfhd: [],\r\n      traf: [],\r\n      trak: [],\r\n      trun: [],\r\n      trex: [],\r\n      tkhd: [],\r\n      vmhd: [],\r\n      smhd: []\r\n    };\r\n\r\n    var i;\r\n    for (i in MP4.types) {\r\n      if (MP4.types.hasOwnProperty(i)) {\r\n        MP4.types[i] = [\r\n          i.charCodeAt(0),\r\n          i.charCodeAt(1),\r\n          i.charCodeAt(2),\r\n          i.charCodeAt(3)\r\n        ];\r\n      }\r\n    }\r\n\r\n    var videoHdlr = new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x00, // pre_defined\r\n      0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x56, 0x69, 0x64, 0x65,\r\n      0x6f, 0x48, 0x61, 0x6e,\r\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'VideoHandler'\r\n    ]);\r\n\r\n    var audioHdlr = new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x00, // pre_defined\r\n      0x73, 0x6f, 0x75, 0x6e, // handler_type: 'soun'\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x53, 0x6f, 0x75, 0x6e,\r\n      0x64, 0x48, 0x61, 0x6e,\r\n      0x64, 0x6c, 0x65, 0x72, 0x00 // name: 'SoundHandler'\r\n    ]);\r\n\r\n    MP4.HDLR_TYPES = {\r\n      'video': videoHdlr,\r\n      'audio': audioHdlr\r\n    };\r\n\r\n    var dref = new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x01, // entry_count\r\n      0x00, 0x00, 0x00, 0x0c, // entry_size\r\n      0x75, 0x72, 0x6c, 0x20, // 'url' type\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x01 // entry_flags\r\n    ]);\r\n\r\n    var stco = new Uint8Array([\r\n      0x00, // version\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x00 // entry_count\r\n    ]);\r\n\r\n    MP4.STTS = MP4.STSC = MP4.STCO = stco;\r\n\r\n    MP4.STSZ = new Uint8Array([\r\n      0x00, // version\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x00, // sample_size\r\n      0x00, 0x00, 0x00, 0x00, // sample_count\r\n    ]);\r\n    MP4.VMHD = new Uint8Array([\r\n      0x00, // version\r\n      0x00, 0x00, 0x01, // flags\r\n      0x00, 0x00, // graphicsmode\r\n      0x00, 0x00,\r\n      0x00, 0x00,\r\n      0x00, 0x00 // opcolor\r\n    ]);\r\n    MP4.SMHD = new Uint8Array([\r\n      0x00, // version\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, // balance\r\n      0x00, 0x00 // reserved\r\n    ]);\r\n\r\n    MP4.STSD = new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x01]);// entry_count\r\n\r\n    var majorBrand = new Uint8Array([105,115,111,109]); // isom\r\n    var avc1Brand = new Uint8Array([97,118,99,49]); // avc1\r\n    var minorVersion = new Uint8Array([0, 0, 0, 1]);\r\n\r\n    MP4.FTYP = MP4.box(MP4.types.ftyp, majorBrand, minorVersion, majorBrand, avc1Brand);\r\n    MP4.DINF = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, dref));\r\n  }\r\n\r\n  static box(type) {\r\n  var\r\n    payload = Array.prototype.slice.call(arguments, 1),\r\n    size = 8,\r\n    i = payload.length,\r\n    len = i,\r\n    result;\r\n    // calculate the total size we need to allocate\r\n    while (i--) {\r\n      size += payload[i].byteLength;\r\n    }\r\n    result = new Uint8Array(size);\r\n    result[0] = (size >> 24) & 0xff;\r\n    result[1] = (size >> 16) & 0xff;\r\n    result[2] = (size >> 8) & 0xff;\r\n    result[3] = size  & 0xff;\r\n    result.set(type, 4);\r\n    // copy the payload into the result\r\n    for (i = 0, size = 8; i < len; i++) {\r\n      // copy payload[i] array @ offset size\r\n      result.set(payload[i], size);\r\n      size += payload[i].byteLength;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  static hdlr(type) {\r\n    return MP4.box(MP4.types.hdlr, MP4.HDLR_TYPES[type]);\r\n  }\r\n\r\n  static mdat(data) {\r\n  //  console.log( \"mdat==> \",data.length );\r\n    return MP4.box(MP4.types.mdat, data);\r\n  }\r\n\r\n  static mdhd(timescale, duration) {\r\n    duration *= timescale;\r\n    return MP4.box(MP4.types.mdhd, new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n      0x00, 0x00, 0x00, 0x02, // creation_time\r\n      0x00, 0x00, 0x00, 0x03, // modification_time\r\n      (timescale >> 24) & 0xFF,\r\n      (timescale >> 16) & 0xFF,\r\n      (timescale >>  8) & 0xFF,\r\n      timescale & 0xFF, // timescale\r\n      (duration >> 24),\r\n      (duration >> 16) & 0xFF,\r\n      (duration >>  8) & 0xFF,\r\n      duration & 0xFF, // duration\r\n      0x55, 0xc4, // 'und' language (undetermined)\r\n      0x00, 0x00\r\n    ]));\r\n  }\r\n\r\n  static mdia(track) {\r\n    return MP4.box(MP4.types.mdia, MP4.mdhd(track.timescale, track.duration), MP4.hdlr(track.type), MP4.minf(track));\r\n  }\r\n\r\n  static mfhd(sequenceNumber) {\r\n    return MP4.box(MP4.types.mfhd, new Uint8Array([\r\n      0x00,\r\n      0x00, 0x00, 0x00, // flags\r\n      (sequenceNumber >> 24),\r\n      (sequenceNumber >> 16) & 0xFF,\r\n      (sequenceNumber >>  8) & 0xFF,\r\n      sequenceNumber & 0xFF, // sequence_number\r\n    ]));\r\n  }\r\n\r\n  static minf(track) {\r\n    if (track.type === 'audio') {\r\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.smhd, MP4.SMHD), MP4.DINF, MP4.stbl(track));\r\n    } else {\r\n      return MP4.box(MP4.types.minf, MP4.box(MP4.types.vmhd, MP4.VMHD), MP4.DINF, MP4.stbl(track));\r\n    }\r\n  }\r\n\r\n  static moof(sn, baseMediaDecodeTime, track) {\r\n    return MP4.box(MP4.types.moof, MP4.mfhd(sn), MP4.traf(track,baseMediaDecodeTime));\r\n  }\r\n/**\r\n * @param tracks... (optional) {array} the tracks associated with this movie\r\n */\r\n  static moov(tracks) {\r\n    var\r\n      i = tracks.length,\r\n      boxes = [];\r\n\r\n    while (i--) {\r\n      boxes[i] = MP4.trak(tracks[i]);\r\n    }\r\n\r\n    return MP4.box.apply(null, [MP4.types.moov, MP4.mvhd(tracks[0].timescale, tracks[0].duration)].concat(boxes).concat(MP4.mvex(tracks)));\r\n  }\r\n\r\n  static mvex(tracks) {\r\n    var\r\n      i = tracks.length,\r\n      boxes = [];\r\n\r\n    while (i--) {\r\n      boxes[i] = MP4.trex(tracks[i]);\r\n    }\r\n    return MP4.box.apply(null, [MP4.types.mvex].concat(boxes));\r\n  }\r\n\r\n  static mvhd(timescale,duration) {\r\n    duration*=timescale;\r\n    var\r\n      bytes = new Uint8Array([\r\n        0x00, // version 0\r\n        0x00, 0x00, 0x00, // flags\r\n        0x00, 0x00, 0x00, 0x01, // creation_time\r\n        0x00, 0x00, 0x00, 0x02, // modification_time\r\n        (timescale >> 24) & 0xFF,\r\n        (timescale >> 16) & 0xFF,\r\n        (timescale >>  8) & 0xFF,\r\n        timescale & 0xFF, // timescale\r\n        (duration >> 24) & 0xFF,\r\n        (duration >> 16) & 0xFF,\r\n        (duration >>  8) & 0xFF,\r\n        duration & 0xFF, // duration\r\n        0x00, 0x01, 0x00, 0x00, // 1.0 rate\r\n        0x01, 0x00, // 1.0 volume\r\n        0x00, 0x00, // reserved\r\n        0x00, 0x00, 0x00, 0x00, // reserved\r\n        0x00, 0x00, 0x00, 0x00, // reserved\r\n        0x00, 0x01, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x01, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00, // pre_defined\r\n        0xff, 0xff, 0xff, 0xff // next_track_ID\r\n      ]);\r\n    return MP4.box(MP4.types.mvhd, bytes);\r\n  }\r\n\r\n  static sdtp(track) {\r\n    var\r\n      samples = track.samples || [],\r\n      bytes = new Uint8Array(4 + samples.length),\r\n      flags,\r\n      i;\r\n    // leave the full box header (4 bytes) all zero\r\n    // write the sample table\r\n    for (i = 0; i < samples.length; i++) {\r\n      flags = samples[i].flags;\r\n      bytes[i + 4] = (flags.dependsOn << 4) |\r\n        (flags.isDependedOn << 2) |\r\n        (flags.hasRedundancy);\r\n    }\r\n\r\n    return MP4.box(MP4.types.sdtp, bytes);\r\n  }\r\n\r\n  static stbl(track) {\r\n    return MP4.box(MP4.types.stbl, MP4.stsd(track), MP4.box(MP4.types.stts, MP4.STTS), MP4.box(MP4.types.stsc, MP4.STSC), MP4.box(MP4.types.stsz, MP4.STSZ), MP4.box(MP4.types.stco, MP4.STCO));\r\n  }\r\n\r\n  static avc1(track) {\r\n    var sps = [], pps = [], i, data, len;\r\n    // assemble the SPSs\r\n\r\n    for (i = 0; i < track.sps.length; i++) {\r\n      data = track.sps[i];\r\n      len = data.byteLength;\r\n      sps.push((len >>> 8) & 0xFF);\r\n      sps.push((len & 0xFF));\r\n      sps = sps.concat(Array.prototype.slice.call(data)); // SPS\r\n    }\r\n\r\n    // assemble the PPSs\r\n    for (i = 0; i < track.pps.length; i++) {\r\n      data = track.pps[i];\r\n      len = data.byteLength;\r\n      pps.push((len >>> 8) & 0xFF);\r\n      pps.push((len & 0xFF));\r\n      pps = pps.concat(Array.prototype.slice.call(data));\r\n    }\r\n\r\n    var avcc = MP4.box(MP4.types.avcC, new Uint8Array([\r\n            0x01,   // version\r\n            sps[3], // profile\r\n            sps[4], // profile compat\r\n            sps[5], // level\r\n            0xfc | 3, // lengthSizeMinusOne, hard-coded to 4 bytes\r\n            0xE0 | track.sps.length // 3bit reserved (111) + numOfSequenceParameterSets\r\n          ].concat(sps).concat([\r\n            track.pps.length // numOfPictureParameterSets\r\n          ]).concat(pps))), // \"PPS\"\r\n        width = track.width,\r\n        height = track.height;\r\n    //console.log('avcc:' + Hex.hexDump(avcc));\r\n    return MP4.box(MP4.types.avc1, new Uint8Array([\r\n        0x00, 0x00, 0x00, // reserved\r\n        0x00, 0x00, 0x00, // reserved\r\n        0x00, 0x01, // data_reference_index\r\n        0x00, 0x00, // pre_defined\r\n        0x00, 0x00, // reserved\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00, // pre_defined\r\n        (width >> 8) & 0xFF,\r\n        width & 0xff, // width\r\n        (height >> 8) & 0xFF,\r\n        height & 0xff, // height\r\n        0x00, 0x48, 0x00, 0x00, // horizresolution\r\n        0x00, 0x48, 0x00, 0x00, // vertresolution\r\n        0x00, 0x00, 0x00, 0x00, // reserved\r\n        0x00, 0x01, // frame_count\r\n        0x12,\r\n        0x6a, 0x65, 0x66, 0x66, // wfs.js\r\n        0x2d, 0x79, 0x61, 0x6e,\r\n        0x2f, 0x2f, 0x2f, 0x67,\r\n        0x77, 0x66, 0x73, 0x2E,\r\n        0x6A, 0x73, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, 0x00,\r\n        0x00, 0x00, 0x00, // compressorname\r\n        0x00, 0x18,   // depth = 24\r\n        0x11, 0x11]), // pre_defined = -1\r\n          avcc,\r\n          MP4.box(MP4.types.btrt, new Uint8Array([\r\n            0x00, 0x1c, 0x9c, 0x80, // bufferSizeDB\r\n            0x00, 0x2d, 0xc6, 0xc0, // maxBitrate\r\n            0x00, 0x2d, 0xc6, 0xc0])) // avgBitrate\r\n          );\r\n  }       \r\n\r\n  static esds(track) {\r\n    var configlen = track.config.length;\r\n    return new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n\r\n      0x03, // descriptor_type\r\n      0x17+configlen, // length\r\n      0x00, 0x01, //es_id\r\n      0x00, // stream_priority\r\n\r\n      0x04, // descriptor_type\r\n      0x0f+configlen, // length\r\n      0x40, //codec : mpeg4_audio\r\n      0x15, // stream_type\r\n      0x00, 0x00, 0x00, // buffer_size\r\n      0x00, 0x00, 0x00, 0x00, // maxBitrate\r\n      0x00, 0x00, 0x00, 0x00, // avgBitrate\r\n\r\n      0x05 // descriptor_type\r\n      ].concat([configlen]).concat(track.config).concat([0x06, 0x01, 0x02])); // GASpecificConfig)); // length + audio config descriptor\r\n  }\r\n\r\n  static mp4a(track) {\r\n    var audiosamplerate = track.audiosamplerate;\r\n      return MP4.box(MP4.types.mp4a, new Uint8Array([\r\n      0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x01, // data_reference_index\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, track.channelCount, // channelcount\r\n      0x00, 0x10, // sampleSize:16bits\r\n      0x00, 0x00, 0x00, 0x00, // reserved2\r\n      (audiosamplerate >> 8) & 0xFF,\r\n      audiosamplerate & 0xff, //\r\n      0x00, 0x00]),\r\n      MP4.box(MP4.types.esds, MP4.esds(track)));\r\n  }\r\n\r\n  static stsd(track) {\r\n    if (track.type === 'audio') {\r\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.mp4a(track));\r\n    } else {\r\n      return MP4.box(MP4.types.stsd, MP4.STSD, MP4.avc1(track));\r\n    }\r\n  }\r\n\r\n  static tkhd(track) {\r\n    var id = track.id,\r\n        duration = track.duration*track.timescale,\r\n        width = track.width,\r\n        height = track.height;\r\n\r\n     //   console.log( \"tkhd==> \",track.id, track.duration, track.timescale, width,height );\r\n\r\n    return MP4.box(MP4.types.tkhd, new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x07, // flags\r\n      0x00, 0x00, 0x00, 0x00, // creation_time\r\n      0x00, 0x00, 0x00, 0x00, // modification_time\r\n      (id >> 24) & 0xFF,\r\n      (id >> 16) & 0xFF,\r\n      (id >> 8) & 0xFF,\r\n      id & 0xFF, // track_ID\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      (duration >> 24),\r\n      (duration >> 16) & 0xFF,\r\n      (duration >>  8) & 0xFF,\r\n      duration & 0xFF, // duration\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00, // reserved\r\n      0x00, 0x00, // layer\r\n      0x00, 0x00, // alternate_group\r\n      0x00, 0x00, // non-audio track volume\r\n      0x00, 0x00, // reserved\r\n      0x00, 0x01, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x01, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x00, 0x00, 0x00, 0x00,\r\n      0x40, 0x00, 0x00, 0x00, // transformation: unity matrix\r\n      (width >> 8) & 0xFF,\r\n      width & 0xFF,\r\n      0x00, 0x00, // width\r\n      (height >> 8) & 0xFF,\r\n      height & 0xFF,\r\n      0x00, 0x00 // height\r\n    ]));\r\n  }\r\n\r\n  static traf(track,baseMediaDecodeTime) {\r\n    var sampleDependencyTable = MP4.sdtp(track),\r\n        id = track.id;\r\n      \r\n\r\n\r\n     //  console.log( \"traf==> \",id ,baseMediaDecodeTime);\r\n\r\n    return MP4.box(MP4.types.traf,\r\n               MP4.box(MP4.types.tfhd, new Uint8Array([\r\n                 0x00, // version 0\r\n                 0x00, 0x00, 0x00, // flags\r\n                 (id >> 24),\r\n                 (id >> 16) & 0XFF,\r\n                 (id >> 8) & 0XFF,\r\n                 (id & 0xFF) // track_ID\r\n               ])),\r\n               MP4.box(MP4.types.tfdt, new Uint8Array([\r\n                 0x00, // version 0\r\n                 0x00, 0x00, 0x00, // flags\r\n                 (baseMediaDecodeTime >>24),\r\n                 (baseMediaDecodeTime >> 16) & 0XFF,\r\n                 (baseMediaDecodeTime >> 8) & 0XFF,\r\n                 (baseMediaDecodeTime & 0xFF) // baseMediaDecodeTime\r\n               ])),\r\n               MP4.trun(track,\r\n                    sampleDependencyTable.length +\r\n                    16 + // tfhd\r\n                    16 + // tfdt\r\n                    8 +  // traf header\r\n                    16 + // mfhd\r\n                    8 +  // moof header\r\n                    8),  // mdat header\r\n               sampleDependencyTable);\r\n  }\r\n\r\n  /**\r\n   * Generate a track box.\r\n   * @param track {object} a track definition\r\n   * @return {Uint8Array} the track box\r\n   */\r\n  static trak(track) {\r\n    track.duration = track.duration || 0xffffffff;\r\n    return MP4.box(MP4.types.trak, MP4.tkhd(track), MP4.mdia(track));\r\n  }\r\n\r\n  static trex(track) {\r\n    var id = track.id;\r\n    return MP4.box(MP4.types.trex, new Uint8Array([\r\n      0x00, // version 0\r\n      0x00, 0x00, 0x00, // flags\r\n     (id >> 24),\r\n     (id >> 16) & 0XFF,\r\n     (id >> 8) & 0XFF,\r\n     (id & 0xFF), // track_ID\r\n      0x00, 0x00, 0x00, 0x01, // default_sample_description_index\r\n      0x00, 0x00, 0x00, 0x00, // default_sample_duration\r\n      0x00, 0x00, 0x00, 0x00, // default_sample_size\r\n      0x00, 0x01, 0x00, 0x01 // default_sample_flags\r\n    ]));\r\n  }\r\n\r\n  static trun(track, offset) {\r\n    var samples= track.samples || [],\r\n        len = samples.length,\r\n        arraylen = 12 + (16 * len),\r\n        array = new Uint8Array(arraylen),\r\n        i,sample,duration,size,flags,cts;\r\n\r\n//sample = samples[0];\r\n //       console.log( \"trun==> \",sample.duration, sample.cts ,sample.size,len );\r\n\r\n    offset += 8 + arraylen;\r\n    array.set([\r\n      0x00, // version 0\r\n      0x00, 0x0f, 0x01, // flags\r\n      (len >>> 24) & 0xFF,\r\n      (len >>> 16) & 0xFF,\r\n      (len >>> 8) & 0xFF,\r\n      len & 0xFF, // sample_count\r\n      (offset >>> 24) & 0xFF,\r\n      (offset >>> 16) & 0xFF,\r\n      (offset >>> 8) & 0xFF,\r\n      offset & 0xFF // data_offset\r\n    ],0);\r\n    for (i = 0; i < len; i++) {\r\n      sample = samples[i];\r\n      duration = sample.duration;\r\n      size = sample.size;\r\n      flags = sample.flags;\r\n      cts = sample.cts;\r\n      array.set([\r\n        (duration >>> 24) & 0xFF,\r\n        (duration >>> 16) & 0xFF,\r\n        (duration >>> 8) & 0xFF,\r\n        duration & 0xFF, // sample_duration\r\n        (size >>> 24) & 0xFF,\r\n        (size >>> 16) & 0xFF,\r\n        (size >>> 8) & 0xFF,\r\n        size & 0xFF, // sample_size\r\n        (flags.isLeading << 2) | flags.dependsOn,\r\n        (flags.isDependedOn << 6) |\r\n          (flags.hasRedundancy << 4) |\r\n          (flags.paddingValue << 1) |\r\n          flags.isNonSync,\r\n        flags.degradPrio & 0xF0 << 8,\r\n        flags.degradPrio & 0x0F, // sample_flags\r\n        (cts >>> 24) & 0xFF,\r\n        (cts >>> 16) & 0xFF,\r\n        (cts >>> 8) & 0xFF,\r\n        cts & 0xFF // sample_composition_time_offset\r\n      ],12+16*i);\r\n    }\r\n    return MP4.box(MP4.types.trun, array);\r\n  }\r\n\r\n  static initSegment(tracks) {\r\n    if (!MP4.types) {\r\n      MP4.init();\r\n    }\r\n    var movie = MP4.moov(tracks), result;\r\n    result = new Uint8Array(MP4.FTYP.byteLength + movie.byteLength);\r\n    result.set(MP4.FTYP);\r\n    result.set(movie, MP4.FTYP.byteLength);\r\n\r\n \r\n    return result;\r\n  }\r\n}\r\n\r\nexport default MP4;\r\n",
    "/**\r\n * fMP4 remuxer\r\n*/\r\nimport AAC from '../helper/aac';\r\nimport Event from '../events';\r\nimport {logger} from '../utils/logger';\r\nimport MP4 from '../remux/mp4-generator';\r\nimport {ErrorTypes, ErrorDetails} from '../errors';\r\nimport '../utils/polyfill';\r\n\r\nclass MP4Remuxer {\r\n  constructor(observer, id, config) {\r\n    this.observer = observer;\r\n    this.id = id;\r\n    this.config = config;\r\n    this.ISGenerated = false;\r\n    this.PES2MP4SCALEFACTOR = 4;\r\n    this.PES_TIMESCALE = 90000;\r\n    this.MP4_TIMESCALE = this.PES_TIMESCALE / this.PES2MP4SCALEFACTOR;\r\n    this.nextAvcDts = 90300;\r\n    this.H264_TIMEBASE = 3000;\r\n  }\r\n\r\n  get passthrough() {\r\n    return false;\r\n  }\r\n\r\n  destroy() {\r\n  }\r\n\r\n  insertDiscontinuity() {\r\n    this._initPTS = this._initDTS = undefined;\r\n  }\r\n\r\n  switchLevel() {\r\n    this.ISGenerated = false;\r\n  }\r\n   \r\n  pushVideo(level, sn, videoTrack, timeOffset, contiguous) {    \r\n    this.level = level;\r\n    this.sn = sn;\r\n    let videoData;\r\n    // generate Init Segment if needed\r\n    if (!this.ISGenerated) {\r\n      this.generateVideoIS(videoTrack,timeOffset);\r\n    }    \r\n    if (this.ISGenerated) {\r\n      if (videoTrack.samples.length) { \r\n        this.remuxVideo_2(videoTrack,timeOffset,contiguous);   \r\n      }\r\n    }  \r\n  }\r\n \r\n  remuxVideo_2(track, timeOffset, contiguous, audioTrackLength) {\r\n    var offset = 8,\r\n      pesTimeScale = this.PES_TIMESCALE,\r\n      pes2mp4ScaleFactor = this.PES2MP4SCALEFACTOR,\r\n      mp4SampleDuration,\r\n      mdat, moof,\r\n      firstPTS, firstDTS,\r\n      nextDTS, \r\n      inputSamples = track.samples,\r\n      outputSamples = [];\r\n   \r\n    /* concatenate the video data and construct the mdat in place\r\n      (need 8 more bytes to fill length and mpdat type) */\r\n    mdat = new Uint8Array(track.len + (4 * track.nbNalu) + 8);\r\n    let view = new DataView(mdat.buffer);\r\n    view.setUint32(0, mdat.byteLength);\r\n    mdat.set(MP4.types.mdat, 4);   \r\n    var sampleDuration=0;\r\n    let ptsnorm, dtsnorm, mp4Sample, lastDTS;\r\n\r\n    for (let i = 0; i < inputSamples.length; i++) {\r\n      let avcSample = inputSamples[i],\r\n          mp4SampleLength = 0,\r\n          compositionTimeOffset;\r\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\r\n      while (avcSample.units.units.length) {\r\n        let unit = avcSample.units.units.shift();\r\n        view.setUint32(offset, unit.data.byteLength);\r\n        offset += 4;\r\n        mdat.set(unit.data, offset);\r\n        offset += unit.data.byteLength;\r\n        mp4SampleLength += 4 + unit.data.byteLength;\r\n      }\r\n    \r\n      let pts = avcSample.pts - this._initPTS;\r\n      let dts = avcSample.dts - this._initDTS; \r\n      dts = Math.min(pts,dts);\r\n\r\n      if (lastDTS !== undefined) {\r\n        ptsnorm = this._PTSNormalize(pts, lastDTS);\r\n        dtsnorm = this._PTSNormalize(dts, lastDTS);\r\n        sampleDuration = (dtsnorm - lastDTS)  \r\n        if (sampleDuration <= 0) {\r\n          logger.log (`invalid sample duration at PTS/DTS: ${avcSample.pts}/${avcSample.dts}|dts norm: ${dtsnorm}|lastDTS: ${lastDTS}:${sampleDuration}`);\r\n          sampleDuration = 1;\r\n        }\r\n      } else {\r\n        var nextAvcDts = this.nextAvcDts, delta;\r\n        ptsnorm = this._PTSNormalize(pts, nextAvcDts);\r\n        dtsnorm = this._PTSNormalize(dts, nextAvcDts);\r\n        if (nextAvcDts) {\r\n          delta = Math.round((dtsnorm - nextAvcDts) );\r\n          if (/*contiguous ||*/ Math.abs(delta) < 600) {\r\n            if (delta) {\r\n              if (delta > 1) {\r\n                logger.log (`AVC:${delta} ms hole between fragments detected,filling it`);\r\n              } else if (delta < -1) {\r\n                logger.log (`AVC:${(-delta)} ms overlapping between fragments detected`);\r\n              }\r\n              dtsnorm = nextAvcDts;\r\n              ptsnorm = Math.max(ptsnorm - delta, dtsnorm);\r\n              logger.log (`Video/PTS/DTS adjusted: ${ptsnorm}/${dtsnorm},delta:${delta}`);\r\n            }\r\n          }\r\n        }\r\n        this.firstPTS = Math.max(0, ptsnorm);\r\n        this.firstDTS = Math.max(0, dtsnorm);\r\n        sampleDuration = 0.03; \r\n      }\r\n \r\n      outputSamples.push({\r\n        size: mp4SampleLength,  \r\n        duration:  this.H264_TIMEBASE, \r\n        cts: 0,\r\n        flags: {\r\n          isLeading: 0,\r\n          isDependedOn: 0,\r\n          hasRedundancy: 0,\r\n          degradPrio: 0,\r\n          dependsOn : avcSample.key ? 2 : 1,\r\n          isNonSync : avcSample.key ? 0 : 1\r\n        }\r\n      });\r\n     lastDTS = dtsnorm;\r\n\r\n    }\r\n\r\n    var lastSampleDuration = 0;\r\n    if (outputSamples.length >= 2) {\r\n      lastSampleDuration = outputSamples[outputSamples.length - 2].duration;\r\n      outputSamples[0].duration = lastSampleDuration;\r\n    }\r\n    this.nextAvcDts = dtsnorm + lastSampleDuration;\r\n    let dropped = track.dropped;\r\n    track.len = 0;\r\n    track.nbNalu = 0;\r\n    track.dropped = 0;\r\n    if(outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\r\n      let flags = outputSamples[0].flags; \r\n      flags.dependsOn = 2;\r\n      flags.isNonSync = 0;\r\n    }\r\n    track.samples = outputSamples; \r\n    moof = MP4.moof(track.sequenceNumber++, dtsnorm  , track);\r\n    track.samples = [];\r\n\r\n    let data = {\r\n      id : this.id,\r\n      level : this.level,\r\n      sn : this.sn,\r\n      data1: moof,\r\n      data2: mdat,\r\n      startPTS: ptsnorm, \r\n      endPTS: ptsnorm, \r\n      startDTS: dtsnorm, \r\n      endDTS: dtsnorm, \r\n      type: 'video',\r\n      nb: outputSamples.length,\r\n      dropped : dropped\r\n    };\r\n    \r\n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);    \r\n    return data;\r\n  }\r\n  \r\n  generateVideoIS(videoTrack,timeOffset) {\r\n    var observer = this.observer,       \r\n        videoSamples = videoTrack.samples,\r\n        pesTimeScale = this.PES_TIMESCALE,\r\n        tracks = {},\r\n        data = { id : this.id, level : this.level, sn : this.sn, tracks : tracks, unique : false },\r\n        computePTSDTS = (this._initPTS === undefined),\r\n        initPTS, initDTS;\r\n\r\n    if (computePTSDTS) {\r\n      initPTS = initDTS = Infinity;\r\n    }\r\n \r\n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\r\n      videoTrack.timescale = 90000;//this.MP4_TIMESCALE;\r\n      tracks.video = {\r\n        container : 'video/mp4',\r\n        codec :  videoTrack.codec,\r\n        initSegment : MP4.initSegment([videoTrack]),\r\n        metadata : {\r\n          width : videoTrack.width,\r\n          height : videoTrack.height\r\n        }\r\n      };\r\n      if (computePTSDTS) { \r\n        initPTS = Math.min(initPTS,videoSamples[0].pts - this.H264_TIMEBASE);\r\n        initDTS = Math.min(initDTS,videoSamples[0].dts - this.H264_TIMEBASE );\r\n      }\r\n    }\r\n\r\n    if(Object.keys(tracks).length) {      \r\n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,data);      \r\n      this.ISGenerated = true;\r\n      if (computePTSDTS) {\r\n        this._initPTS = initPTS;\r\n        this._initDTS = initDTS; \r\n      }\r\n    } else {\r\n      console.log( \"generateVideoIS ERROR==> \", ErrorTypes.MEDIA_ERROR);  \r\n    }\r\n  }\r\n \r\n  remux(level,sn,audioTrack,videoTrack,id3Track,textTrack,timeOffset, contiguous) {\r\n    this.level = level;\r\n    this.sn = sn;\r\n    // generate Init Segment if needed\r\n    if (!this.ISGenerated) {\r\n      this.generateIS(audioTrack,videoTrack,timeOffset);\r\n    }\r\n\r\n    if (this.ISGenerated) {\r\n      // Purposefully remuxing audio before video, so that remuxVideo can use nextAacPts, which is\r\n      // calculated in remuxAudio.\r\n      //logger.log('nb AAC samples:' + audioTrack.samples.length);\r\n      if (audioTrack.samples.length) {\r\n        let audioData = this.remuxAudio(audioTrack,timeOffset,contiguous);\r\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\r\n        if (videoTrack.samples.length) {\r\n          let audioTrackLength;\r\n          if (audioData) {\r\n            audioTrackLength = audioData.endPTS - audioData.startPTS;\r\n          }\r\n          this.remuxVideo(videoTrack,timeOffset,contiguous,audioTrackLength);\r\n        }\r\n      } else {\r\n        let videoData;\r\n        //logger.log('nb AVC samples:' + videoTrack.samples.length);\r\n        if (videoTrack.samples.length) {\r\n          videoData = this.remuxVideo(videoTrack,timeOffset,contiguous);\r\n        }\r\n        if (videoData && audioTrack.codec) {\r\n          this.remuxEmptyAudio(audioTrack, timeOffset, contiguous, videoData);\r\n        }\r\n      }\r\n    }\r\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\r\n    if (id3Track.samples.length) {\r\n      this.remuxID3(id3Track,timeOffset);\r\n    }\r\n    //logger.log('nb ID3 samples:' + audioTrack.samples.length);\r\n    if (textTrack.samples.length) {\r\n      this.remuxText(textTrack,timeOffset);\r\n    }\r\n    //notify end of parsing\r\n    this.observer.trigger(Event.FRAG_PARSED, { id : this.id , level : this.level, sn : this.sn});\r\n  }\r\n\r\n  generateIS(audioTrack,videoTrack,timeOffset) {\r\n    var observer = this.observer,\r\n        audioSamples = audioTrack.samples,\r\n        videoSamples = videoTrack.samples,\r\n        pesTimeScale = this.PES_TIMESCALE,\r\n        tracks = {},\r\n        data = { id : this.id, level : this.level, sn : this.sn, tracks : tracks, unique : false },\r\n        computePTSDTS = (this._initPTS === undefined),\r\n        initPTS, initDTS;\r\n\r\n    if (computePTSDTS) {\r\n      initPTS = initDTS = Infinity;\r\n    }\r\n    if (audioTrack.config && audioSamples.length) {\r\n      audioTrack.timescale = audioTrack.audiosamplerate;\r\n      // MP4 duration (track duration in seconds multiplied by timescale) is coded on 32 bits\r\n      // we know that each AAC sample contains 1024 frames....\r\n      // in order to avoid overflowing the 32 bit counter for large duration, we use smaller timescale (timescale/gcd)\r\n      // we just need to ensure that AAC sample duration will still be an integer (will be 1024/gcd)\r\n      if (audioTrack.timescale * audioTrack.duration > Math.pow(2, 32)) {\r\n        let greatestCommonDivisor = function(a, b) {\r\n            if ( ! b) {\r\n                return a;\r\n            }\r\n            return greatestCommonDivisor(b, a % b);\r\n        };\r\n        audioTrack.timescale = audioTrack.audiosamplerate / greatestCommonDivisor(audioTrack.audiosamplerate,1024);\r\n      }\r\n      logger.log ('audio mp4 timescale :'+ audioTrack.timescale);\r\n      tracks.audio = {\r\n        container : 'audio/mp4',\r\n        codec :  audioTrack.codec,\r\n        initSegment : MP4.initSegment([audioTrack]),\r\n        metadata : {\r\n          channelCount : audioTrack.channelCount\r\n        }\r\n      };\r\n      if (computePTSDTS) {\r\n        // remember first PTS of this demuxing context. for audio, PTS + DTS ...\r\n        initPTS = initDTS = audioSamples[0].pts - pesTimeScale * timeOffset;\r\n      }\r\n    }\r\n\r\n    if (videoTrack.sps && videoTrack.pps && videoSamples.length) {\r\n      videoTrack.timescale = this.MP4_TIMESCALE;\r\n      tracks.video = {\r\n        container : 'video/mp4',\r\n        codec :  videoTrack.codec,\r\n        initSegment : MP4.initSegment([videoTrack]),\r\n        metadata : {\r\n          width : videoTrack.width,\r\n          height : videoTrack.height\r\n        }\r\n      };\r\n      if (computePTSDTS) {\r\n        initPTS = Math.min(initPTS,videoSamples[0].pts - pesTimeScale * timeOffset);\r\n        initDTS = Math.min(initDTS,videoSamples[0].dts - pesTimeScale * timeOffset);\r\n      }\r\n    }\r\n\r\n    if(Object.keys(tracks).length) {\r\n      observer.trigger(Event.FRAG_PARSING_INIT_SEGMENT,data);\r\n      this.ISGenerated = true;\r\n      if (computePTSDTS) {\r\n        this._initPTS = initPTS;\r\n        this._initDTS = initDTS;\r\n      }\r\n    } else {\r\n      observer.trigger(Event.ERROR, {type : ErrorTypes.MEDIA_ERROR, id : this.id, details: ErrorDetails.FRAG_PARSING_ERROR, fatal: false, reason: 'no audio/video samples found'});\r\n    }\r\n  }\r\n\r\n  remuxVideo(track, timeOffset, contiguous, audioTrackLength) {\r\n    var offset = 8,\r\n        pesTimeScale = this.PES_TIMESCALE,\r\n        pes2mp4ScaleFactor = this.PES2MP4SCALEFACTOR,\r\n        mp4SampleDuration,\r\n        mdat, moof,\r\n        firstPTS, firstDTS,\r\n        nextDTS,\r\n        lastPTS, lastDTS,\r\n        inputSamples = track.samples,\r\n        outputSamples = [];\r\n\r\n  // PTS is coded on 33bits, and can loop from -2^32 to 2^32\r\n  // PTSNormalize will make PTS/DTS value monotonic, we use last known DTS value as reference value\r\n   let nextAvcDts;\r\n    if (contiguous) {\r\n      // if parsed fragment is contiguous with last one, let's use last DTS value as reference\r\n      nextAvcDts = this.nextAvcDts;\r\n    } else {\r\n      // if not contiguous, let's use target timeOffset\r\n      nextAvcDts = timeOffset*pesTimeScale;\r\n    }\r\n\r\n    // compute first DTS and last DTS, normalize them against reference value\r\n    let sample = inputSamples[0];\r\n    firstDTS =  Math.max(this._PTSNormalize(sample.dts,nextAvcDts) - this._initDTS,0);\r\n    firstPTS =  Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS,0);\r\n \r\n    // check timestamp continuity accross consecutive fragments (this is to remove inter-fragment gap/hole)\r\n    let delta = Math.round((firstDTS - nextAvcDts) / 90);\r\n    // if fragment are contiguous, detect hole/overlapping between fragments\r\n    if (contiguous) {\r\n      if (delta) {\r\n        if (delta > 1) {\r\n          logger.log(`AVC:${delta} ms hole between fragments detected,filling it`);\r\n        } else if (delta < -1) {\r\n          logger.log(`AVC:${(-delta)} ms overlapping between fragments detected`);\r\n        }\r\n        // remove hole/gap : set DTS to next expected DTS\r\n        firstDTS = nextAvcDts;\r\n        inputSamples[0].dts = firstDTS + this._initDTS;\r\n        // offset PTS as well, ensure that PTS is smaller or equal than new DTS\r\n        firstPTS = Math.max(firstPTS - delta, nextAvcDts);\r\n        inputSamples[0].pts = firstPTS + this._initDTS;\r\n        logger.log(`Video/PTS/DTS adjusted: ${firstPTS}/${firstDTS},delta:${delta}`);\r\n      }\r\n    }\r\n    nextDTS = firstDTS;\r\n \r\n    // compute lastPTS/lastDTS\r\n    sample = inputSamples[inputSamples.length-1];\r\n    lastDTS = Math.max(this._PTSNormalize(sample.dts,nextAvcDts) - this._initDTS,0);\r\n    lastPTS = Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS,0);\r\n    lastPTS = Math.max(lastPTS, lastDTS);\r\n\r\n    let vendor = navigator.vendor, userAgent = navigator.userAgent,\r\n        isSafari = vendor && vendor.indexOf('Apple') > -1 && userAgent && !userAgent.match('CriOS');\r\n\r\n      // on Safari let's signal the same sample duration for all samples\r\n      // sample duration (as expected by trun MP4 boxes), should be the delta between sample DTS\r\n      // set this constant duration as being the avg delta between consecutive DTS.\r\n    if (isSafari) {\r\n      mp4SampleDuration = Math.round((lastDTS-firstDTS)/(pes2mp4ScaleFactor*(inputSamples.length-1)));\r\n    }\r\n\r\n    // normalize all PTS/DTS now ...\r\n    for (let i = 0; i < inputSamples.length; i++) {\r\n      let sample = inputSamples[i];\r\n      if (isSafari) {\r\n        // sample DTS is computed using a constant decoding offset (mp4SampleDuration) between samples\r\n        sample.dts = firstDTS + i*pes2mp4ScaleFactor*mp4SampleDuration;\r\n      } else {\r\n        // ensure sample monotonic DTS\r\n        sample.dts = Math.max(this._PTSNormalize(sample.dts, nextAvcDts) - this._initDTS,firstDTS);\r\n        // ensure dts is a multiple of scale factor to avoid rounding issues\r\n        sample.dts = Math.round(sample.dts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor;\r\n      }\r\n      // we normalize PTS against nextAvcDts, we also substract initDTS (some streams don't start @ PTS O)\r\n      // and we ensure that computed value is greater or equal than sample DTS\r\n      sample.pts = Math.max(this._PTSNormalize(sample.pts,nextAvcDts) - this._initDTS, sample.dts);\r\n      // ensure pts is a multiple of scale factor to avoid rounding issues\r\n      sample.pts = Math.round(sample.pts/pes2mp4ScaleFactor)*pes2mp4ScaleFactor;\r\n\r\n    }\r\n \r\n    /* concatenate the video data and construct the mdat in place\r\n      (need 8 more bytes to fill length and mpdat type) */\r\n    mdat = new Uint8Array(track.len + (4 * track.nbNalu) + 8);\r\n    let view = new DataView(mdat.buffer);\r\n    view.setUint32(0, mdat.byteLength);\r\n    mdat.set(MP4.types.mdat, 4);\r\n\r\n    for (let i = 0; i < inputSamples.length; i++) {\r\n      let avcSample = inputSamples[i],\r\n          mp4SampleLength = 0,\r\n          compositionTimeOffset;\r\n      // convert NALU bitstream to MP4 format (prepend NALU with size field)\r\n      while (avcSample.units.units.length) {\r\n        let unit = avcSample.units.units.shift();\r\n        view.setUint32(offset, unit.data.byteLength);\r\n        offset += 4;\r\n        mdat.set(unit.data, offset);\r\n        offset += unit.data.byteLength;\r\n        mp4SampleLength += 4 + unit.data.byteLength;\r\n      }\r\n\r\n      if(!isSafari) {\r\n        // expected sample duration is the Decoding Timestamp diff of consecutive samples\r\n        if (i < inputSamples.length - 1) {\r\n          mp4SampleDuration = inputSamples[i+1].dts - avcSample.dts;\r\n        } else {\r\n          let config = this.config,\r\n              lastFrameDuration = avcSample.dts - inputSamples[i > 0 ? i-1 : i].dts;\r\n          if (config.stretchShortVideoTrack) {\r\n            // In some cases, a segment's audio track duration may exceed the video track duration.\r\n            // Since we've already remuxed audio, and we know how long the audio track is, we look to\r\n            // see if the delta to the next segment is longer than the minimum of maxBufferHole and\r\n            // maxSeekHole. If so, playback would potentially get stuck, so we artificially inflate\r\n            // the duration of the last frame to minimize any potential gap between segments.\r\n            let maxBufferHole = config.maxBufferHole,\r\n                maxSeekHole = config.maxSeekHole,\r\n                gapTolerance = Math.floor(Math.min(maxBufferHole, maxSeekHole) * pesTimeScale),\r\n                deltaToFrameEnd = (audioTrackLength ? firstPTS + audioTrackLength * pesTimeScale : this.nextAacPts) - avcSample.pts;\r\n            if (deltaToFrameEnd > gapTolerance) {\r\n              // We subtract lastFrameDuration from deltaToFrameEnd to try to prevent any video\r\n              // frame overlap. maxBufferHole/maxSeekHole should be >> lastFrameDuration anyway.\r\n              mp4SampleDuration = deltaToFrameEnd - lastFrameDuration;\r\n              if (mp4SampleDuration < 0) {\r\n                mp4SampleDuration = lastFrameDuration;\r\n              }\r\n              logger.log(`It is approximately ${deltaToFrameEnd/90} ms to the next segment; using duration ${mp4SampleDuration/90} ms for the last video frame.`);\r\n            } else {\r\n              mp4SampleDuration = lastFrameDuration;\r\n            }\r\n          } else {\r\n            mp4SampleDuration = lastFrameDuration;\r\n          }\r\n        }\r\n        mp4SampleDuration /= pes2mp4ScaleFactor;\r\n        compositionTimeOffset = Math.round((avcSample.pts - avcSample.dts) / pes2mp4ScaleFactor);\r\n      } else {\r\n        compositionTimeOffset = Math.max(0,mp4SampleDuration*Math.round((avcSample.pts - avcSample.dts)/(pes2mp4ScaleFactor*mp4SampleDuration)));\r\n      }\r\n     outputSamples.push({\r\n        size: mp4SampleLength,\r\n         // constant duration\r\n        duration: mp4SampleDuration,\r\n        cts: compositionTimeOffset,\r\n        flags: {\r\n          isLeading: 0,\r\n          isDependedOn: 0,\r\n          hasRedundancy: 0,\r\n          degradPrio: 0,\r\n          dependsOn : avcSample.key ? 2 : 1,\r\n          isNonSync : avcSample.key ? 0 : 1\r\n        }\r\n      });\r\n    }\r\n    // next AVC sample DTS should be equal to last sample DTS + last sample duration (in PES timescale)\r\n    this.nextAvcDts = lastDTS + mp4SampleDuration*pes2mp4ScaleFactor;\r\n    let dropped = track.dropped;\r\n    track.len = 0;\r\n    track.nbNalu = 0;\r\n    track.dropped = 0;\r\n    if(outputSamples.length && navigator.userAgent.toLowerCase().indexOf('chrome') > -1) {\r\n      let flags = outputSamples[0].flags;\r\n    // chrome workaround, mark first sample as being a Random Access Point to avoid sourcebuffer append issue\r\n    // https://code.google.com/p/chromium/issues/detail?id=229412\r\n      flags.dependsOn = 2;\r\n      flags.isNonSync = 0;\r\n    }\r\n    track.samples = outputSamples;\r\n    moof = MP4.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\r\n    track.samples = [];\r\n\r\n    let data = {\r\n      id : this.id,\r\n      level : this.level,\r\n      sn : this.sn,\r\n      data1: moof,\r\n      data2: mdat,\r\n      startPTS: firstPTS / pesTimeScale,\r\n      endPTS: (lastPTS + pes2mp4ScaleFactor * mp4SampleDuration) / pesTimeScale,\r\n      startDTS: firstPTS / pesTimeScale,\r\n      endDTS: (lastPTS + pes2mp4ScaleFactor * mp4SampleDuration) / pesTimeScale,\r\n     // startDTS: firstDTS / pesTimeScale,\r\n     // endDTS: this.nextAvcDts / pesTimeScale,\r\n      type: 'video',\r\n      nb: outputSamples.length,\r\n      dropped : dropped\r\n    };\r\n    this.observer.trigger(Event.FRAG_PARSING_DATA, data);\r\n    return data;\r\n  }\r\n\r\n  remuxAudio(track, timeOffset, contiguous) {\r\n    let pesTimeScale = this.PES_TIMESCALE,\r\n        mp4timeScale = track.timescale,\r\n        pes2mp4ScaleFactor = pesTimeScale/mp4timeScale,\r\n        expectedSampleDuration = track.timescale * 1024 / track.audiosamplerate;\r\n    var view,\r\n        offset = 8,\r\n        aacSample, mp4Sample,\r\n        unit,\r\n        mdat, moof,\r\n        firstPTS, firstDTS, lastDTS,\r\n        pts, dts, ptsnorm, dtsnorm,\r\n        samples = [],\r\n        samples0 = [];\r\n\r\n    track.samples.sort(function(a, b) {\r\n      return (a.pts-b.pts);\r\n    });\r\n    samples0 = track.samples;\r\n\r\n    let nextAacPts = (contiguous ? this.nextAacPts : timeOffset*pesTimeScale);\r\n\r\n    // If the audio track is missing samples, the frames seem to get \"left-shifted\" within the\r\n    // resulting mp4 segment, causing sync issues and leaving gaps at the end of the audio segment.\r\n    // In an effort to prevent this from happening, we inject frames here where there are gaps.\r\n    // When possible, we inject a silent frame; when that's not possible, we duplicate the last\r\n    // frame.\r\n    let firstPtsNorm = this._PTSNormalize(samples0[0].pts - this._initPTS, nextAacPts),\r\n        pesFrameDuration = expectedSampleDuration * pes2mp4ScaleFactor;\r\n    var nextPtsNorm = firstPtsNorm + pesFrameDuration;\r\n    for (var i = 1; i < samples0.length; ) {\r\n      // First, let's see how far off this frame is from where we expect it to be\r\n      var sample = samples0[i],\r\n          ptsNorm = this._PTSNormalize(sample.pts - this._initPTS, nextAacPts),\r\n          delta = ptsNorm - nextPtsNorm;\r\n\r\n      // If we're overlapping by more than half a duration, drop this sample\r\n      if (delta < (-0.5 * pesFrameDuration)) {\r\n        logger.log(`Dropping frame due to ${Math.abs(delta / 90)} ms overlap.`);\r\n        samples0.splice(i, 1);\r\n        track.len -= sample.unit.length;\r\n        // Don't touch nextPtsNorm or i\r\n      }\r\n      // Otherwise, if we're more than half a frame away from where we should be, insert missing frames\r\n      else if (delta > (0.5 * pesFrameDuration)) {\r\n        var missing = Math.round(delta / pesFrameDuration);\r\n        logger.log(`Injecting ${missing} frame${missing > 1 ? 's' : ''} of missing audio due to ${Math.round(delta / 90)} ms gap.`);\r\n        for (var j = 0; j < missing; j++) {\r\n          var newStamp = samples0[i - 1].pts + pesFrameDuration,\r\n              fillFrame = AAC.getSilentFrame(track.channelCount);\r\n          if (!fillFrame) {\r\n            logger.log('Unable to get silent frame for given audio codec; duplicating last frame instead.');\r\n            fillFrame = sample.unit.slice(0);\r\n          }\r\n          samples0.splice(i, 0, {unit: fillFrame, pts: newStamp, dts: newStamp});\r\n          track.len += fillFrame.length;\r\n          i += 1;\r\n        }\r\n\r\n        // Adjust sample to next expected pts\r\n        nextPtsNorm += (missing + 1) * pesFrameDuration;\r\n        sample.pts = samples0[i - 1].pts + pesFrameDuration;\r\n        i += 1;\r\n      }\r\n      // Otherwise, we're within half a frame duration, so just adjust pts\r\n      else {\r\n        if (Math.abs(delta) > (0.1 * pesFrameDuration)) {\r\n          logger.log(`Invalid frame delta ${ptsNorm - nextPtsNorm + pesFrameDuration} at PTS ${Math.round(ptsNorm / 90)} (should be ${pesFrameDuration}).`);\r\n        }\r\n        nextPtsNorm += pesFrameDuration;\r\n        sample.pts = samples0[i - 1].pts + pesFrameDuration;\r\n        i += 1;\r\n      }\r\n    }\r\n\r\n    while (samples0.length) {\r\n      aacSample = samples0.shift();\r\n      unit = aacSample.unit;\r\n      pts = aacSample.pts - this._initDTS;\r\n      dts = aacSample.dts - this._initDTS;\r\n      //logger.log(`Audio/PTS:${Math.round(pts/90)}`);\r\n      // if not first sample\r\n      if (lastDTS !== undefined) {\r\n        ptsnorm = this._PTSNormalize(pts, lastDTS);\r\n        dtsnorm = this._PTSNormalize(dts, lastDTS);\r\n        mp4Sample.duration = (dtsnorm - lastDTS) / pes2mp4ScaleFactor;\r\n      } else {\r\n        ptsnorm = this._PTSNormalize(pts, nextAacPts);\r\n        dtsnorm = this._PTSNormalize(dts, nextAacPts);\r\n        let delta = Math.round(1000 * (ptsnorm - nextAacPts) / pesTimeScale);\r\n        // if fragment are contiguous, detect hole/overlapping between fragments\r\n        if (contiguous) {\r\n          // log delta\r\n          if (delta) {\r\n            if (delta > 0) {\r\n              logger.log(`${delta} ms hole between AAC samples detected,filling it`);\r\n              // if we have frame overlap, overlapping for more than half a frame duraion\r\n            } else if (delta < -12) {\r\n              // drop overlapping audio frames... browser will deal with it\r\n              logger.log(`${(-delta)} ms overlapping between AAC samples detected, drop frame`);\r\n              track.len -= unit.byteLength;\r\n              continue;\r\n            }\r\n            // set PTS/DTS to expected PTS/DTS\r\n            ptsnorm = dtsnorm = nextAacPts;\r\n          }\r\n        }\r\n        // remember first PTS of our aacSamples, ensure value is positive\r\n        firstPTS = Math.max(0, ptsnorm);\r\n        firstDTS = Math.max(0, dtsnorm);\r\n        if(track.len > 0) {\r\n          /* concatenate the audio data and construct the mdat in place\r\n            (need 8 more bytes to fill length and mdat type) */\r\n          mdat = new Uint8Array(track.len + 8);\r\n          view = new DataView(mdat.buffer);\r\n          view.setUint32(0, mdat.byteLength);\r\n          mdat.set(MP4.types.mdat, 4);\r\n        } else {\r\n          // no audio samples\r\n          return;\r\n        }\r\n      }\r\n      mdat.set(unit, offset);\r\n      offset += unit.byteLength;\r\n      //console.log('PTS/DTS/initDTS/normPTS/normDTS/relative PTS : ${aacSample.pts}/${aacSample.dts}/${this._initDTS}/${ptsnorm}/${dtsnorm}/${(aacSample.pts/4294967296).toFixed(3)}');\r\n      mp4Sample = {\r\n        size: unit.byteLength,\r\n        cts: 0,\r\n        duration:0,\r\n        flags: {\r\n          isLeading: 0,\r\n          isDependedOn: 0,\r\n          hasRedundancy: 0,\r\n          degradPrio: 0,\r\n          dependsOn: 1,\r\n        }\r\n      };\r\n      samples.push(mp4Sample);\r\n      lastDTS = dtsnorm;\r\n    }\r\n    var lastSampleDuration = 0;\r\n    var nbSamples = samples.length;\r\n    //set last sample duration as being identical to previous sample\r\n    if (nbSamples >= 2) {\r\n      lastSampleDuration = samples[nbSamples - 2].duration;\r\n      mp4Sample.duration = lastSampleDuration;\r\n    }\r\n    if (nbSamples) {\r\n      // next aac sample PTS should be equal to last sample PTS + duration\r\n      this.nextAacPts = ptsnorm + pes2mp4ScaleFactor * lastSampleDuration;\r\n      //logger.log('Audio/PTS/PTSend:' + aacSample.pts.toFixed(0) + '/' + this.nextAacDts.toFixed(0));\r\n      track.len = 0;\r\n      track.samples = samples;\r\n      moof = MP4.moof(track.sequenceNumber++, firstDTS / pes2mp4ScaleFactor, track);\r\n      track.samples = [];\r\n      let audioData = {\r\n        id : this.id,\r\n        level : this.level,\r\n        sn : this.sn,\r\n        data1: moof,\r\n        data2: mdat,\r\n        startPTS: firstPTS / pesTimeScale,\r\n        endPTS: this.nextAacPts / pesTimeScale,\r\n        startDTS: firstDTS / pesTimeScale,\r\n        endDTS: (dtsnorm + pes2mp4ScaleFactor * lastSampleDuration) / pesTimeScale,\r\n        type: 'audio',\r\n        nb: nbSamples\r\n      };\r\n      this.observer.trigger(Event.FRAG_PARSING_DATA, audioData);\r\n      return audioData;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  remuxEmptyAudio(track, timeOffset, contiguous, videoData) {\r\n    let pesTimeScale = this.PES_TIMESCALE,\r\n        mp4timeScale = track.timescale ? track.timescale : track.audiosamplerate,\r\n        pes2mp4ScaleFactor = pesTimeScale/mp4timeScale,\r\n\r\n        // sync with video's timestamp\r\n        startDTS = videoData.startDTS * pesTimeScale + this._initDTS,\r\n        endDTS = videoData.endDTS * pesTimeScale + this._initDTS,\r\n\r\n        // one sample's duration value\r\n        sampleDuration = 1024,\r\n        frameDuration = pes2mp4ScaleFactor * sampleDuration,\r\n\r\n        // samples count of this segment's duration\r\n        nbSamples = Math.ceil((endDTS - startDTS) / frameDuration),\r\n\r\n        // silent frame\r\n        silentFrame = AAC.getSilentFrame(track.channelCount);\r\n\r\n    // Can't remux if we can't generate a silent frame...\r\n    if (!silentFrame) {\r\n      logger.trace('Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!');\r\n      return;\r\n    }\r\n\r\n    let samples = [];\r\n    for(var i = 0; i < nbSamples; i++) {\r\n      var stamp = startDTS + i * frameDuration;\r\n      samples.push({unit: silentFrame.slice(0), pts: stamp, dts: stamp});\r\n      track.len += silentFrame.length;\r\n    }\r\n    track.samples = samples;\r\n\r\n    this.remuxAudio(track, timeOffset, contiguous);\r\n  }\r\n\r\n  remuxID3(track,timeOffset) {\r\n    var length = track.samples.length, sample;\r\n    // consume samples\r\n    if(length) {\r\n      for(var index = 0; index < length; index++) {\r\n        sample = track.samples[index];\r\n        // setting id3 pts, dts to relative time\r\n        // using this._initPTS and this._initDTS to calculate relative time\r\n        sample.pts = ((sample.pts - this._initPTS) / this.PES_TIMESCALE);\r\n        sample.dts = ((sample.dts - this._initDTS) / this.PES_TIMESCALE);\r\n      }\r\n      this.observer.trigger(Event.FRAG_PARSING_METADATA, {\r\n        id : this.id,\r\n        level : this.level,\r\n        sn : this.sn,\r\n        samples:track.samples\r\n      });\r\n    }\r\n\r\n    track.samples = [];\r\n    timeOffset = timeOffset;\r\n  }\r\n\r\n  remuxText(track,timeOffset) {\r\n    track.samples.sort(function(a, b) {\r\n      return (a.pts-b.pts);\r\n    });\r\n\r\n    var length = track.samples.length, sample;\r\n    // consume samples\r\n    if(length) {\r\n      for(var index = 0; index < length; index++) {\r\n        sample = track.samples[index];\r\n        // setting text pts, dts to relative time\r\n        // using this._initPTS and this._initDTS to calculate relative time\r\n        sample.pts = ((sample.pts - this._initPTS) / this.PES_TIMESCALE);\r\n      }\r\n      this.observer.trigger(Event.FRAG_PARSING_USERDATA, {\r\n        id : this.id,\r\n        level : this.level,\r\n        sn : this.sn,\r\n        samples:track.samples\r\n      });\r\n    }\r\n\r\n    track.samples = [];\r\n    timeOffset = timeOffset;\r\n  }\r\n\r\n  _PTSNormalize(value, reference) {\r\n    var offset;\r\n    if (reference === undefined) {\r\n      return value;\r\n    }\r\n    if (reference < value) {\r\n      // - 2^33\r\n      offset = -8589934592;\r\n    } else {\r\n      // + 2^33\r\n      offset = 8589934592;\r\n    }\r\n    /* PTS is 33bit (from 0 to 2^33 -1)\r\n      if diff between value and reference is bigger than half of the amplitude (2^32) then it means that\r\n      PTS looping occured. fill the gap */\r\n    while (Math.abs(value - reference) > 4294967296) {\r\n        value += offset;\r\n    }\r\n    return value;\r\n  }\r\n\r\n}\r\n\r\nexport default MP4Remuxer;\r\n",
    "/*\r\n * H264 NAL Slicer\r\n */\r\nimport Event from '../events';\r\nimport EventHandler from '../event-handler';\r\nimport H264Demuxer from '../demux/h264-demuxer';\r\n\r\nclass SlicesReader extends EventHandler {\r\n\r\n    constructor(wfs, config = null) {\r\n        super(wfs, Event.H264_DATA_PARSING);\r\n\r\n        this.config = this.wfs.config || config;\r\n        this.h264Demuxer = new H264Demuxer(wfs);\r\n        this.wfs = wfs;\r\n        this.lastBuf = null;\r\n        this.nals = [];\r\n    }\r\n\r\n    destroy() {\r\n        this.lastBuf = null;\r\n        this.nals = [];\r\n        EventHandler.prototype.destroy.call(this);\r\n    }\r\n\r\n    _read(buffer) {\r\n        var typedAr = null;\r\n        this.nals = [];\r\n        if (!buffer || buffer.byteLength < 1) return;\r\n        if (this.lastBuf) {\r\n            typedAr = new Uint8Array(buffer.byteLength + this.lastBuf.length);\r\n            typedAr.set(this.lastBuf);\r\n            typedAr.set(new Uint8Array(buffer), this.lastBuf.length);\r\n        } else {\r\n            typedAr = new Uint8Array(buffer);\r\n        }\r\n        var lastNalEndPos = 0;\r\n        var b1 = -1; // byte before one\r\n        var b2 = -2; // byte before two\r\n        var nalStartPos = new Array();\r\n        for (var i = 0; i < typedAr.length; i += 2) {\r\n            var b_0 = typedAr[i];\r\n            var b_1 = typedAr[i + 1];\r\n            if (b1 == 0 && b_0 == 0 && b_1 == 0) {\r\n                nalStartPos.push(i - 1);\r\n            } else if (b_1 == 1 && b_0 == 0 && b1 == 0 && b2 == 0) {\r\n                nalStartPos.push(i - 2);\r\n            }\r\n            b2 = b_0;\r\n            b1 = b_1;\r\n        }\r\n        if (nalStartPos.length > 1) {\r\n            for (var i = 0; i < nalStartPos.length - 1; ++i) {\r\n                this.nals.push(typedAr.subarray(nalStartPos[i], nalStartPos[i + 1] + 1));\r\n                lastNalEndPos = nalStartPos[i + 1];\r\n            }\r\n        } else {\r\n            lastNalEndPos = nalStartPos[0];\r\n        }\r\n        if (lastNalEndPos != 0 && lastNalEndPos < typedAr.length) {\r\n            this.lastBuf = typedAr.subarray(lastNalEndPos);\r\n        } else {\r\n            if ( !! !this.lastBuf) {\r\n                this.lastBuf = typedAr;\r\n            }\r\n            var _newBuf = new Uint8Array(this.lastBuf.length + buffer.byteLength);\r\n            _newBuf.set(this.lastBuf);\r\n            _newBuf.set(new Uint8Array(buffer), this.lastBuf.length);\r\n            this.lastBuf = _newBuf;\r\n        }\r\n    }\r\n\r\n\tonH264DataParsing(event) {\r\n\t\tthis._read(event.data);\r\n\t\tvar $this = this;\r\n\t\tthis.nals.forEach(function(nal) {\r\n\t\t\t$this.wfs.trigger(Event.H264_DATA_PARSED, {\r\n\t\t\t\tdata: nal\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default SlicesReader;",
    "'use strict';\r\n\r\nfunction noop() {}\r\n\r\nconst fakeLogger = {\r\n  trace: noop,\r\n  debug: noop,\r\n  log: noop,\r\n  warn: noop,\r\n  info: noop,\r\n  error: noop\r\n};\r\n\r\nlet exportedLogger = fakeLogger;\r\n\r\n//let lastCallTime;\r\n// function formatMsgWithTimeInfo(type, msg) {\r\n//   const now = Date.now();\r\n//   const diff = lastCallTime ? '+' + (now - lastCallTime) : '0';\r\n//   lastCallTime = now;\r\n//   msg = (new Date(now)).toISOString() + ' | [' +  type + '] > ' + msg + ' ( ' + diff + ' ms )';\r\n//   return msg;\r\n// }\r\n\r\nfunction formatMsg(type, msg) {\r\n  msg = '[' +  type + '] > ' + msg;\r\n  return msg;\r\n}\r\n\r\nfunction consolePrintFn(type) {\r\n  const func = window.console[type];\r\n  if (func) {\r\n    return function(...args) {\r\n      if(args[0]) {\r\n        args[0] = formatMsg(type, args[0]);\r\n      }\r\n      func.apply(window.console, args);\r\n    };\r\n  }\r\n  return noop;\r\n}\r\n\r\nfunction exportLoggerFunctions(debugConfig, ...functions) {\r\n  functions.forEach(function(type) {\r\n    exportedLogger[type] = debugConfig[type] ? debugConfig[type].bind(debugConfig) : consolePrintFn(type);\r\n  });\r\n}\r\n\r\nexport var enableLogs = function(debugConfig) {\r\n  if (debugConfig === true || typeof debugConfig === 'object') {\r\n    exportLoggerFunctions(debugConfig,\r\n      // Remove out from list here to hard-disable a log-level\r\n      //'trace',\r\n      'debug',\r\n      'log',\r\n      'info',\r\n      'warn',\r\n      'error'\r\n    );\r\n    // Some browsers don't allow to use bind on console object anyway\r\n    // fallback to default if needed\r\n    try {\r\n     exportedLogger.log();\r\n    } catch (e) {\r\n      exportedLogger = fakeLogger;\r\n    }\r\n  }\r\n  else {\r\n    exportedLogger = fakeLogger;\r\n  }\r\n};\r\n\r\nexport var logger = exportedLogger;\r\n",
    "if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\r\n  ArrayBuffer.prototype.slice = function (start, end) {\r\n    var that = new Uint8Array(this);\r\n    if (end === undefined) {\r\n      end = that.length;\r\n    }\r\n    var result = new ArrayBuffer(end - start);\r\n    var resultArray = new Uint8Array(result);\r\n    for (var i = 0; i < resultArray.length; i++) {\r\n      resultArray[i] = that[i + start];\r\n    }\r\n    return result;\r\n  };\r\n}\r\n",
    "/**\r\n * XHR based logger\r\n*/\r\n\r\n \r\nclass XhrLoader {\r\n\r\n  constructor(config) {\r\n    if (config && config.xhrSetup) {\r\n      this.xhrSetup = config.xhrSetup;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.abort();\r\n    this.loader = null;\r\n  }\r\n\r\n  abort() {\r\n    var loader = this.loader;\r\n    if (loader && loader.readyState !== 4) {\r\n      this.stats.aborted = true;\r\n      loader.abort();\r\n    }\r\n\r\n    window.clearTimeout(this.requestTimeout);\r\n    this.requestTimeout = null;\r\n    window.clearTimeout(this.retryTimeout);\r\n    this.retryTimeout = null;\r\n  }\r\n\r\n  loadHead(context, config, callbacks) {\r\n    this.context = context;\r\n    this.config = config;\r\n    this.callbacks = callbacks;\r\n    this.stats = {trequest: performance.now(), retry: 0};\r\n    this.retryDelay = config.retryDelay;\r\n    var xhr = new XMLHttpRequest;\r\n    xhr.open('head', context.url);\r\n    xhr.onload = function () {\r\n          callbacks.onSuccess(xhr.getResponseHeader('content-length'));\r\n    };\r\n    xhr.send();\r\n  }\r\n\r\n  load(context, config, callbacks) {\r\n    this.context = context;\r\n    this.config = config;\r\n    this.callbacks = callbacks;\r\n    this.stats = {trequest: performance.now(), retry: 0};\r\n    this.retryDelay = config.retryDelay;\r\n    this.loadInternal(); \r\n  }\r\n \r\n  loadInternal() {\r\n    var xhr, context = this.context;\r\n    if (typeof XDomainRequest !== 'undefined') {\r\n       xhr = this.loader = new XDomainRequest();\r\n    } else {\r\n       xhr = this.loader = new XMLHttpRequest();\r\n    }\r\n    xhr.onloadend = this.loadend.bind(this);\r\n    xhr.onprogress = this.loadprogress.bind(this);\r\n    xhr.open('GET', context.url, true);\r\n    if (context.rangeEnd) {\r\n      xhr.setRequestHeader('Range','bytes=' + context.rangeStart + '-' + (context.rangeEnd-1));\r\n    }\r\n    xhr.responseType = context.responseType;\r\n    let stats = this.stats;\r\n    stats.tfirst = 0;\r\n    stats.loaded = 0;\r\n    if (this.xhrSetup) {\r\n      this.xhrSetup(xhr, context.url);\r\n    }     \r\n    // setup timeout before we perform request\r\n    this.requestTimeout = window.setTimeout(this.loadtimeout.bind(this), this.config.timeout);\r\n    xhr.send();\r\n  }\r\n\r\n  loadend(event) {\r\n    var xhr = event.currentTarget,\r\n        status = xhr.status,\r\n        stats = this.stats,\r\n        context = this.context,\r\n        config = this.config;\r\n    // don't proceed if xhr has been aborted\r\n    if (stats.aborted) {\r\n      return;\r\n    }\r\n    // in any case clear the current xhrs timeout\r\n    window.clearTimeout(this.requestTimeout);\r\n\r\n    // http status between 200 to 299 are all successful\r\n    if (status >= 200 && status < 300)  {\r\n      stats.tload = Math.max(stats.tfirst,performance.now());\r\n      let data,len;\r\n      if (context.responseType === 'arraybuffer') {\r\n        data = xhr.response;\r\n        len = data.byteLength;\r\n      } else {\r\n        data = xhr.responseText;\r\n        len = data.length;\r\n      }\r\n      stats.loaded = stats.total = len;\r\n      let response = { url : xhr.responseURL, data : data };\r\n      this.callbacks.onSuccess(response, stats, context);\r\n    } else {\r\n      // if max nb of retries reached or if http status between 400 and 499 (such error cannot be recovered, retrying is useless), return error\r\n      if (stats.retry >= config.maxRetry || (status >= 400 && status < 499)) {\r\n      //  logger.error(`${status} while loading ${context.url}` );\r\n        this.callbacks.onError({ code : status, text : xhr.statusText}, context);\r\n      } else {\r\n      // retry\r\n      //  logger.warn(`${status} while loading ${context.url}, retrying in ${this.retryDelay}...`);\r\n        // aborts and resets internal state\r\n        this.destroy();\r\n        // schedule retry\r\n        this.retryTimeout = window.setTimeout(this.loadInternal.bind(this), this.retryDelay);\r\n        // set exponential backoff\r\n        this.retryDelay = Math.min(2 * this.retryDelay, config.maxRetryDelay);\r\n        stats.retry++;\r\n      }\r\n    }\r\n  }\r\n\r\n  loadtimeout() {\r\n  //  logger.warn(`timeout while loading ${this.context.url}` );\r\n    this.callbacks.onTimeout(this.stats, this.context);\r\n  }\r\n\r\n  loadprogress(event) {\r\n    var stats = this.stats;\r\n    if (stats.tfirst === 0) {\r\n      stats.tfirst = Math.max(performance.now(), stats.trequest);\r\n    }\r\n    stats.loaded = event.loaded;\r\n    if (event.lengthComputable) {\r\n      stats.total = event.total;\r\n    }\r\n    let onProgress = this.callbacks.onProgress;\r\n    if (onProgress) {\r\n      // last args is to provide on progress data\r\n      onProgress(stats, this.context, null);\r\n    }\r\n  }\r\n}\r\n\r\nexport default XhrLoader;\r\n",
    "/**\r\n * WFS interface, Jeff Yang 2016.10\r\n */\r\n'use strict';\r\n\r\nimport Event from './events';\r\nimport FlowController from  './controller/flow-controller'; \r\nimport BufferController from  './controller/buffer-controller';\r\nimport EventEmitter from 'events';\r\nimport XhrLoader from './utils/xhr-loader';\r\nimport WebsocketLoader from './loader/websocket-loader';\r\n\r\n\r\nclass Wfs {\r\n\r\n  static get version() {\r\n    // replaced with browserify-versionify transform\r\n    return ''+'v.0.0.0.1';\r\n  }\r\n\r\n  static isSupported() {\r\n    return (window.MediaSource &&\r\n            typeof window.MediaSource.isTypeSupported === 'function' &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42c01f,mp4a.40.2\"'));\r\n  }\r\n  \r\n  static get Events() {\r\n    return Event;\r\n  }\r\n \r\n  static get DefaultConfig() {\r\n    if(!Wfs.defaultConfig) {\r\n       Wfs.defaultConfig = {\r\n        autoStartLoad: true,\r\n        startPosition: -1,\r\n        debug: false, \r\n        fLoader: undefined,\r\n        loader: XhrLoader,\r\n        //loader: FetchLoader,\r\n        fmp4FileUrl: 'xxxx.mp4',\r\n        fragLoadingTimeOut: 20000,\r\n        fragLoadingMaxRetry: 6,\r\n        fragLoadingRetryDelay: 1000,\r\n        fragLoadingMaxRetryTimeout: 64000,\r\n        fragLoadingLoopThreshold: 3,\r\n        forceKeyFrameOnDiscontinuity: true,\r\n        appendErrorMaxRetry: 3\r\n      };\r\n    }\r\n    return Wfs.defaultConfig;\r\n  }\r\n\r\n  static set DefaultConfig(defaultConfig) {\r\n    Wfs.defaultConfig = defaultConfig;\r\n  }\r\n\r\n  constructor(config = {}) {\r\n\r\n    var defaultConfig = Wfs.DefaultConfig;\r\n    for (var prop in defaultConfig) {\r\n        if (prop in config) { continue; }\r\n        config[prop] = defaultConfig[prop];\r\n    }\r\n    this.config = config;  \r\n    // observer setup\r\n    var observer = this.observer = new EventEmitter();\r\n    observer.trigger = function trigger (event, ...data) {\r\n      observer.emit(event, event, ...data);\r\n    };\r\n\r\n    observer.off = function off (event, ...data) {\r\n      observer.removeListener(event, ...data);\r\n    };\r\n    this.on = observer.on.bind(observer);\r\n    this.off = observer.off.bind(observer);\r\n    this.trigger = observer.trigger.bind(observer);\r\n\r\n    this.flowController = new FlowController(this);\r\n    this.bufferController = new BufferController(this);\r\n  //  this.fileLoader = new FileLoader(this);\r\n    this.websocketLoader = new WebsocketLoader(this);\r\n    this.mediaType = undefined;     \r\n  }\r\n\r\n  destroy() {\r\n    this.flowController.destroy();\r\n    this.bufferController.destroy();\r\n //   this.fileLoader.destroy();\r\n    this.websocketLoader.destroy();\r\n  }\r\n\r\n  attachMedia(media, channelName='chX',mediaType='H264Raw', websocketName='play2') { // 'H264Raw' 'FMp4'    \r\n    this.mediaType = mediaType; \r\n    this.media = media;\r\n    this.trigger(Event.MEDIA_ATTACHING, {media:media, channelName:channelName, mediaType:mediaType, websocketName:websocketName });\r\n  }\r\n  \r\n  attachWebsocket(websocket,channelName) { \r\n    this.trigger(Event.WEBSOCKET_ATTACHING, {websocket: websocket, mediaType:this.mediaType, channelName:channelName });\r\n  }\r\n\r\n}\r\n\r\nexport default Wfs;\r\n"
  ]
}